[0m04:38:46.793485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108783890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087839d0>]}


============================== 04:38:46.796711 | b77d18d2-14e4-4901-b6cf-859e06e8369a ==============================
[0m04:38:46.796711 [info ] [MainThread]: Running with dbt=1.11.2
[0m04:38:46.797050 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'empty': 'None', 'profiles_dir': '/Users/bapbap23/.dbt', 'invocation_command': 'dbt debug', 'write_json': 'True'}
[0m04:38:46.811919 [info ] [MainThread]: dbt version: 1.11.2
[0m04:38:46.812256 [info ] [MainThread]: python version: 3.13.7
[0m04:38:46.812443 [info ] [MainThread]: python path: /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/.venv/bin/python3.13
[0m04:38:46.812596 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit-Mach-O
[0m04:38:46.865254 [info ] [MainThread]: Using profiles dir at /Users/bapbap23/.dbt
[0m04:38:46.865521 [info ] [MainThread]: Using profiles.yml file at /Users/bapbap23/.dbt/profiles.yml
[0m04:38:46.865685 [info ] [MainThread]: Using dbt_project.yml file at /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/dbt_project.yml
[0m04:38:46.866016 [info ] [MainThread]: adapter type: postgres
[0m04:38:46.866208 [info ] [MainThread]: adapter version: 1.10.0
[0m04:38:46.920034 [info ] [MainThread]: Configuration:
[0m04:38:46.920327 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:38:46.920488 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:38:46.920638 [info ] [MainThread]: Required dependencies:
[0m04:38:46.920854 [debug] [MainThread]: Executing "git --help"
[0m04:38:46.936506 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:38:46.937136 [debug] [MainThread]: STDERR: "b''"
[0m04:38:46.937345 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:38:46.937526 [info ] [MainThread]: Connection:
[0m04:38:46.937706 [info ] [MainThread]:   host: localhost
[0m04:38:46.937851 [info ] [MainThread]:   port: 5432
[0m04:38:46.937984 [info ] [MainThread]:   user: bapbap23
[0m04:38:46.938112 [info ] [MainThread]:   database: EnterpriseBI
[0m04:38:46.938238 [info ] [MainThread]:   schema: staging
[0m04:38:46.938371 [info ] [MainThread]:   connect_timeout: 10
[0m04:38:46.938498 [info ] [MainThread]:   role: None
[0m04:38:46.938624 [info ] [MainThread]:   search_path: None
[0m04:38:46.938751 [info ] [MainThread]:   keepalives_idle: 0
[0m04:38:46.938876 [info ] [MainThread]:   sslmode: None
[0m04:38:46.939000 [info ] [MainThread]:   sslcert: None
[0m04:38:46.939124 [info ] [MainThread]:   sslkey: None
[0m04:38:46.939253 [info ] [MainThread]:   sslrootcert: None
[0m04:38:46.939380 [info ] [MainThread]:   application_name: dbt
[0m04:38:46.939501 [info ] [MainThread]:   retries: 1
[0m04:38:46.939870 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m04:38:47.055039 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m04:38:47.099741 [debug] [MainThread]: Using postgres connection "debug"
[0m04:38:47.099986 [debug] [MainThread]: On debug: select 1 as id
[0m04:38:47.100139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:38:47.152937 [debug] [MainThread]: SQL status: SELECT 1 in 0.053 seconds
[0m04:38:47.153693 [debug] [MainThread]: On debug: Close
[0m04:38:47.153940 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:38:47.154163 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:38:47.157667 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.41101333, "process_in_blocks": "0", "process_kernel_time": 0.218786, "process_mem_max_rss": "116293632", "process_out_blocks": "0", "process_user_time": 0.859608}
[0m04:38:47.158078 [debug] [MainThread]: Command `dbt debug` succeeded at 04:38:47.157982 after 0.41 seconds
[0m04:38:47.158315 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:38:47.158543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099403e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881ee00>]}
[0m04:38:47.158805 [debug] [MainThread]: Flushing usage events
[0m04:38:47.337911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:39:05.971923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107914590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ab890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ab9d0>]}


============================== 04:39:05.975374 | d63cd403-85af-4560-a9d4-a66fe8870db4 ==============================
[0m04:39:05.975374 [info ] [MainThread]: Running with dbt=1.11.2
[0m04:39:05.975855 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/bapbap23/.dbt', 'target_path': 'None', 'empty': 'None', 'invocation_command': 'dbt show', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None'}
[0m04:39:06.094949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd63cd403-85af-4560-a9d4-a66fe8870db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0d60>]}
[0m04:39:06.127525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd63cd403-85af-4560-a9d4-a66fe8870db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088388d0>]}
[0m04:39:06.139871 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m04:39:06.196741 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m04:39:06.197250 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:39:06.197457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd63cd403-85af-4560-a9d4-a66fe8870db4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109649450>]}
[0m04:39:06.775611 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'enterprise_bi_project' (models/staging/staging.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m04:39:06.775953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd63cd403-85af-4560-a9d4-a66fe8870db4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970cf50>]}
[0m04:39:06.813656 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/marts/marts.yml @ models: {'name': 'fact_orders', 'description': 'Order fact table with metrics and foreign keys to all dimensions', 'columns': [{'name': 'order_key', 'description': 'Surrogate key (primary key) - auto-generated sequential ID', 'tests': ['unique', 'not_null']}, {'name': 'order_code', 'description': 'Business key from source system (ord-XXX)', 'tests': ['unique', 'not_null']}, {'name': 'customer_key', 'description': 'Foreign key to dim_customer', 'tests': ['not_null', {'relationships': {'to': "ref('dim_customer')", 'field': 'customer_key'}}]}, {'name': 'product_key', 'description': 'Foreign key to dim_product', 'tests': ['not_null', {'relationships': {'to': "ref('dim_product')", 'field': 'product_key'}}]}, {'name': 'store_key', 'description': 'Foreign key to dim_store', 'tests': ['not_null', {'relationships': {'to': "ref('dim_store')", 'field': 'store_key'}}]}, {'name': 'order_date_key', 'description': 'Foreign key to dim_date for order date', 'tests': ['not_null', {'relationships': {'to': "ref('dim_date')", 'field': 'date_key'}}]}, {'name': 'ship_date_key', 'description': 'Foreign key to dim_date for ship date (nullable if not shipped)', 'tests': [{'relationships': {'to': "ref('dim_date')", 'field': 'date_key'}}]}, {'name': 'order_amount', 'description': 'Total order value/amount', 'tests': ['not_null']}, {'name': 'quantity', 'description': 'Quantity of items ordered', 'tests': ['not_null']}, {'name': 'discount_amount', 'description': 'Total discount amount applied', 'tests': None}, {'name': 'order_status', 'description': 'Order status', 'tests': ['not_null']}, {'name': 'order_type', 'description': 'Order type', 'tests': ['not_null']}], 'original_file_path': 'models/marts/marts.yml', 'yaml_key': 'models', 'package_name': 'enterprise_bi_project'} - at path ['columns'][9]['tests']: None is not of type 'array'
[0m04:39:06.814281 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m04:39:06.817470 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": false, "command_wall_clock_time": 0.8857965, "process_in_blocks": "0", "process_kernel_time": 0.184397, "process_mem_max_rss": "124239872", "process_out_blocks": "0", "process_user_time": 1.452807}
[0m04:39:06.817727 [debug] [MainThread]: Command `dbt show` failed at 04:39:06.817679 after 0.89 seconds
[0m04:39:06.817927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108783e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a504b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10984a9c0>]}
[0m04:39:06.818113 [debug] [MainThread]: Flushing usage events
[0m04:39:06.983914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:45:22.743893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c93890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c939d0>]}


============================== 04:45:22.748109 | 530edbb4-6db3-4ec2-8551-2d60bee912a3 ==============================
[0m04:45:22.748109 [info ] [MainThread]: Running with dbt=1.11.2
[0m04:45:22.748450 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/bapbap23/.dbt', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m04:45:22.759706 [info ] [MainThread]: dbt version: 1.11.2
[0m04:45:22.760817 [info ] [MainThread]: python version: 3.13.7
[0m04:45:22.761038 [info ] [MainThread]: python path: /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/.venv/bin/python3.13
[0m04:45:22.761297 [info ] [MainThread]: os info: macOS-15.6.1-arm64-arm-64bit-Mach-O
[0m04:45:22.809236 [info ] [MainThread]: Using profiles dir at /Users/bapbap23/.dbt
[0m04:45:22.809507 [info ] [MainThread]: Using profiles.yml file at /Users/bapbap23/.dbt/profiles.yml
[0m04:45:22.809662 [info ] [MainThread]: Using dbt_project.yml file at /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/dbt_project.yml
[0m04:45:22.810019 [info ] [MainThread]: adapter type: postgres
[0m04:45:22.810213 [info ] [MainThread]: adapter version: 1.10.0
[0m04:45:22.862554 [info ] [MainThread]: Configuration:
[0m04:45:22.862836 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:45:22.862997 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:45:22.863167 [info ] [MainThread]: Required dependencies:
[0m04:45:22.863389 [debug] [MainThread]: Executing "git --help"
[0m04:45:22.881318 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:45:22.881990 [debug] [MainThread]: STDERR: "b''"
[0m04:45:22.882206 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:45:22.882377 [info ] [MainThread]: Connection:
[0m04:45:22.882563 [info ] [MainThread]:   host: localhost
[0m04:45:22.882712 [info ] [MainThread]:   port: 5432
[0m04:45:22.882843 [info ] [MainThread]:   user: bapbap23
[0m04:45:22.882971 [info ] [MainThread]:   database: EnterpriseBI
[0m04:45:22.883101 [info ] [MainThread]:   schema: staging
[0m04:45:22.883231 [info ] [MainThread]:   connect_timeout: 10
[0m04:45:22.883364 [info ] [MainThread]:   role: None
[0m04:45:22.883557 [info ] [MainThread]:   search_path: None
[0m04:45:22.883731 [info ] [MainThread]:   keepalives_idle: 0
[0m04:45:22.883859 [info ] [MainThread]:   sslmode: None
[0m04:45:22.883983 [info ] [MainThread]:   sslcert: None
[0m04:45:22.884109 [info ] [MainThread]:   sslkey: None
[0m04:45:22.884230 [info ] [MainThread]:   sslrootcert: None
[0m04:45:22.884361 [info ] [MainThread]:   application_name: dbt
[0m04:45:22.884483 [info ] [MainThread]:   retries: 1
[0m04:45:22.884899 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m04:45:22.934952 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m04:45:22.972461 [debug] [MainThread]: Using postgres connection "debug"
[0m04:45:22.972702 [debug] [MainThread]: On debug: select 1 as id
[0m04:45:22.972861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:45:23.049763 [debug] [MainThread]: SQL status: SELECT 1 in 0.077 seconds
[0m04:45:23.050608 [debug] [MainThread]: On debug: Close
[0m04:45:23.050898 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:45:23.051134 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:45:23.053901 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.35175568, "process_in_blocks": "0", "process_kernel_time": 0.196408, "process_mem_max_rss": "119930880", "process_out_blocks": "0", "process_user_time": 0.838287}
[0m04:45:23.054321 [debug] [MainThread]: Command `dbt debug` succeeded at 04:45:23.054233 after 0.35 seconds
[0m04:45:23.054568 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:45:23.054831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e503e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d26e00>]}
[0m04:45:23.055144 [debug] [MainThread]: Flushing usage events
[0m04:45:23.244525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:10.478098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d79d0>]}


============================== 12:58:10.481812 | b14c3cd2-8fa9-48a1-86a7-67c7d226db43 ==============================
[0m12:58:10.481812 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:58:10.482160 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/bapbap23/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_customers', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'printer_width': '80', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default'}
[0m12:58:10.639159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e8d60>]}
[0m12:58:10.670231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081648d0>]}
[0m12:58:10.670826 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:58:10.727833 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:58:10.728420 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:58:10.728630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108169950>]}
[0m12:58:11.521437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092bf5c0>]}
[0m12:58:11.575468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m12:58:11.576943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m12:58:11.594759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fc9f0>]}
[0m12:58:11.595035 [info ] [MainThread]: Found 11 models, 82 data tests, 5 sources, 464 macros
[0m12:58:11.595211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109912c30>]}
[0m12:58:11.596512 [info ] [MainThread]: 
[0m12:58:11.596708 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:58:11.596854 [info ] [MainThread]: 
[0m12:58:11.597101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:11.597529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m12:58:11.737313 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m12:58:11.737600 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m12:58:11.737765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:11.904903 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.167 seconds
[0m12:58:11.906526 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m12:58:11.907300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now create_EnterpriseBI_staging_staging)
[0m12:58:11.907787 [debug] [ThreadPool]: Creating schema "database: "EnterpriseBI"
schema: "staging_staging"
"
[0m12:58:11.913219 [debug] [ThreadPool]: Using postgres connection "create_EnterpriseBI_staging_staging"
[0m12:58:11.913570 [debug] [ThreadPool]: On create_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "create_EnterpriseBI_staging_staging"} */
create schema if not exists "staging_staging"
[0m12:58:11.913831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:11.942918 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.029 seconds
[0m12:58:11.943809 [debug] [ThreadPool]: On create_EnterpriseBI_staging_staging: COMMIT
[0m12:58:11.944058 [debug] [ThreadPool]: Using postgres connection "create_EnterpriseBI_staging_staging"
[0m12:58:11.944265 [debug] [ThreadPool]: On create_EnterpriseBI_staging_staging: COMMIT
[0m12:58:11.945251 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:58:11.945444 [debug] [ThreadPool]: On create_EnterpriseBI_staging_staging: Close
[0m12:58:11.949051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_EnterpriseBI_staging_staging, now list_EnterpriseBI_staging_mart)
[0m12:58:11.949425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m12:58:11.953579 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m12:58:11.955045 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m12:58:11.955312 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m12:58:11.955561 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m12:58:11.955779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:11.955953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:11.982587 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m12:58:11.982870 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m12:58:11.983599 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m12:58:11.984190 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m12:58:11.984474 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m12:58:11.984626 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m12:58:11.987390 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:11.987645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:58:11.987848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:12.008862 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m12:58:12.009823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ff290>]}
[0m12:58:12.010138 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:12.010448 [debug] [MainThread]: On master: COMMIT
[0m12:58:12.010653 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:12.010812 [debug] [MainThread]: On master: COMMIT
[0m12:58:12.011156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:12.011314 [debug] [MainThread]: On master: Close
[0m12:58:12.014814 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_customers
[0m12:58:12.015127 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_customers ...................... [RUN]
[0m12:58:12.015393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.stg_customers)
[0m12:58:12.015616 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_customers
[0m12:58:12.021050 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_customers"
[0m12:58:12.022336 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_customers
[0m12:58:12.050605 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_customers"
[0m12:58:12.051403 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m12:58:12.051617 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */

  create view "EnterpriseBI"."staging_staging"."stg_customers__dbt_tmp"
    
    
  as (
    select 
    customer_code::text as customer_code,
    signup_date::date as signup_date,
    customer_segment::text as customer_segment,
    email::text as email,
    loyalty_id::text as loyalty_id
from "EnterpriseBI"."raw"."customers"
where customer_code is not null
  );
[0m12:58:12.051809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:12.070903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m12:58:12.075221 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m12:58:12.075494 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */
alter table "EnterpriseBI"."staging_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:58:12.076358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:58:12.084456 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: COMMIT
[0m12:58:12.084725 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m12:58:12.084897 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: COMMIT
[0m12:58:12.134186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m12:58:12.140892 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_customers__dbt_backup"
[0m12:58:12.144213 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m12:58:12.144494 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_customers__dbt_backup" cascade
[0m12:58:12.145161 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:58:12.146806 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: Close
[0m12:58:12.148148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b14c3cd2-8fa9-48a1-86a7-67c7d226db43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf0520>]}
[0m12:58:12.148573 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_customers ................. [[32mCREATE VIEW[0m in 0.13s]
[0m12:58:12.148959 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_customers
[0m12:58:12.149778 [debug] [MainThread]: On master: COMMIT
[0m12:58:12.149979 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:12.150152 [debug] [MainThread]: On master: COMMIT
[0m12:58:12.150314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:12.173535 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m12:58:12.173805 [debug] [MainThread]: On master: Close
[0m12:58:12.174045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:12.174195 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_customers' was properly closed.
[0m12:58:12.174325 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m12:58:12.174485 [info ] [MainThread]: 
[0m12:58:12.174648 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:58:12.174997 [debug] [MainThread]: Command end result
[0m12:58:12.201857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m12:58:12.203276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m12:58:12.206768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m12:58:12.206985 [info ] [MainThread]: 
[0m12:58:12.207195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:12.207351 [info ] [MainThread]: 
[0m12:58:12.207523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:58:12.209742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7770811, "process_in_blocks": "0", "process_kernel_time": 0.260942, "process_mem_max_rss": "132087808", "process_out_blocks": "0", "process_user_time": 1.826814}
[0m12:58:12.209994 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:12.209947 after 1.78 seconds
[0m12:58:12.210205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d053b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ef4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dd6d0>]}
[0m12:58:12.210395 [debug] [MainThread]: Flushing usage events
[0m12:58:12.419648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:11.915884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106390590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd79d0>]}


============================== 14:24:11.919759 | a17b8785-5f9f-4b12-9724-f5389f86bc62 ==============================
[0m14:24:11.919759 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:24:11.920108 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/Users/bapbap23/.dbt', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_products', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:24:12.032140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a17b8785-5f9f-4b12-9724-f5389f86bc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106540d60>]}
[0m14:24:12.063115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a17b8785-5f9f-4b12-9724-f5389f86bc62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208648d0>]}
[0m14:24:12.063676 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:24:12.118750 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:24:12.185174 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading enterprise_bi_project: staging/staging.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |           # - accepted_values:
    19 |           #     values: ['consumer', 'corporate', 'home office']
    20 |               
    21 |   version: 2
    22 | 
    23 | models:
    24 |   - name: stg_orders_line
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 21, column 3
[0m14:24:12.187477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3161027, "process_in_blocks": "0", "process_kernel_time": 0.183985, "process_mem_max_rss": "115212288", "process_out_blocks": "0", "process_user_time": 0.918668}
[0m14:24:12.187746 [debug] [MainThread]: Command `dbt run` failed at 14:24:12.187687 after 0.32 seconds
[0m14:24:12.187976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ad1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ad1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12171ff20>]}
[0m14:24:12.188184 [debug] [MainThread]: Flushing usage events
[0m14:24:12.387545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:35.598521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da79d0>]}


============================== 14:25:35.602083 | 259b0997-9ee7-4538-b88a-77ceded48ef5 ==============================
[0m14:25:35.602083 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:25:35.602419 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run --select stg_products', 'use_colors': 'True', 'introspect': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/Users/bapbap23/.dbt', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True'}
[0m14:25:35.719993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bcd60>]}
[0m14:25:35.750787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e348d0>]}
[0m14:25:35.751515 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:25:35.807241 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:25:35.895934 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m14:25:35.896369 [debug] [MainThread]: Partial parsing: added file: enterprise_bi_project://models/staging/stg_orders_line.sql
[0m14:25:35.896714 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/staging.yml
[0m14:25:35.896873 [debug] [MainThread]: Partial parsing: deleted file: enterprise_bi_project://models/staging/stg_orders.sql
[0m14:25:35.897080 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_products.sql
[0m14:25:35.897294 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_stores.sql
[0m14:25:35.897488 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_regions.sql
[0m14:25:36.124118 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'stg_orders_line' in package 'enterprise_bi_project'
(models/staging/staging.yml). Arguments to generic tests should be nested under
the `arguments` property.
[0m14:25:36.124425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed2050>]}
[0m14:25:36.182816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4fe30>]}
[0m14:25:36.238182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:25:36.239808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:25:36.257919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b26d0>]}
[0m14:25:36.258208 [info ] [MainThread]: Found 11 models, 81 data tests, 5 sources, 464 macros
[0m14:25:36.258396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c6410>]}
[0m14:25:36.259662 [info ] [MainThread]: 
[0m14:25:36.259837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:36.259982 [info ] [MainThread]: 
[0m14:25:36.260224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:36.260646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m14:25:36.303934 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m14:25:36.304174 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m14:25:36.304336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:36.514109 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.210 seconds
[0m14:25:36.515164 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m14:25:36.518407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m14:25:36.518812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m14:25:36.522047 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m14:25:36.523139 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m14:25:36.523371 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:25:36.523615 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m14:25:36.523814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:36.523976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:36.546108 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m14:25:36.546392 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.023 seconds
[0m14:25:36.547531 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m14:25:36.548221 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m14:25:36.549785 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m14:25:36.550035 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m14:25:36.555298 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:36.555586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:25:36.555840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:36.575847 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m14:25:36.576671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618f290>]}
[0m14:25:36.576944 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:36.577202 [debug] [MainThread]: On master: COMMIT
[0m14:25:36.577400 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:36.577553 [debug] [MainThread]: On master: COMMIT
[0m14:25:36.577827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:36.577976 [debug] [MainThread]: On master: Close
[0m14:25:36.579569 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_products
[0m14:25:36.579856 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_products ....................... [RUN]
[0m14:25:36.580097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.stg_products)
[0m14:25:36.580278 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_products
[0m14:25:36.585090 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_products"
[0m14:25:36.585568 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_products
[0m14:25:36.607278 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_products"
[0m14:25:36.607871 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m14:25:36.608081 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */

  create view "EnterpriseBI"."staging_staging"."stg_products__dbt_tmp"
    
    
  as (
    select 
    product_code::text as product_code,
    product_name::text as product_name,
    category::text as category,
    base_price::float as base_price,
    active_flag::text as active_flag
from "EnterpriseBI"."raw"."products"
where product_code is not null
  );
[0m14:25:36.608272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:36.629284 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m14:25:36.633090 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m14:25:36.633311 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */
alter table "EnterpriseBI"."staging_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:25:36.634874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:36.643315 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_products: COMMIT
[0m14:25:36.643579 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m14:25:36.643759 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_products: COMMIT
[0m14:25:36.644579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:25:36.647847 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_products__dbt_backup"
[0m14:25:36.652545 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m14:25:36.652809 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_products__dbt_backup" cascade
[0m14:25:36.653500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:25:36.654901 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_products: Close
[0m14:25:36.656042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259b0997-9ee7-4538-b88a-77ceded48ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106122e60>]}
[0m14:25:36.656407 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_products .................. [[32mCREATE VIEW[0m in 0.08s]
[0m14:25:36.656720 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_products
[0m14:25:36.657425 [debug] [MainThread]: On master: COMMIT
[0m14:25:36.657626 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:36.657781 [debug] [MainThread]: On master: COMMIT
[0m14:25:36.657928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:36.673880 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m14:25:36.674154 [debug] [MainThread]: On master: Close
[0m14:25:36.674404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:36.674587 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_products' was properly closed.
[0m14:25:36.674757 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_mart' was properly closed.
[0m14:25:36.674928 [info ] [MainThread]: 
[0m14:25:36.675092 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m14:25:36.675436 [debug] [MainThread]: Command end result
[0m14:25:36.700822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:25:36.702044 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:25:36.705287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m14:25:36.705478 [info ] [MainThread]: 
[0m14:25:36.705690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:36.705847 [info ] [MainThread]: 
[0m14:25:36.706023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:25:36.706290 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:25:36.708504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.154125, "process_in_blocks": "0", "process_kernel_time": 0.226265, "process_mem_max_rss": "129646592", "process_out_blocks": "0", "process_user_time": 1.382077}
[0m14:25:36.708766 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:36.708721 after 1.15 seconds
[0m14:25:36.708969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f61130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e842d0>]}
[0m14:25:36.709169 [debug] [MainThread]: Flushing usage events
[0m14:25:36.967858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:16.747379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105038590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d79d0>]}


============================== 14:28:16.751248 | 03debde8-0fb7-405b-8752-9ecf8fd28e6f ==============================
[0m14:28:16.751248 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:28:16.751586 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/Users/bapbap23/.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'static_parser': 'True', 'empty': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_regions'}
[0m14:28:16.869834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e8d60>]}
[0m14:28:16.901215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074648d0>]}
[0m14:28:16.901819 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:28:16.957091 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:28:17.054123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:17.054390 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:28:17.054536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:17.079621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107469950>]}
[0m14:28:17.169992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:28:17.172162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:28:17.189963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ffc50>]}
[0m14:28:17.190275 [info ] [MainThread]: Found 11 models, 81 data tests, 5 sources, 464 macros
[0m14:28:17.190456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107991e10>]}
[0m14:28:17.191769 [info ] [MainThread]: 
[0m14:28:17.191939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:17.192079 [info ] [MainThread]: 
[0m14:28:17.192327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:17.192757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m14:28:17.236350 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m14:28:17.236592 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m14:28:17.236748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:17.308201 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.071 seconds
[0m14:28:17.309280 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m14:28:17.312972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m14:28:17.313363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m14:28:17.317294 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m14:28:17.318775 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m14:28:17.319034 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m14:28:17.319273 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:28:17.319479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:17.319653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:17.339065 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m14:28:17.339399 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.020 seconds
[0m14:28:17.340305 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m14:28:17.341122 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m14:28:17.341458 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m14:28:17.341653 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m14:28:17.345079 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.345380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:28:17.345622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:17.364144 [debug] [MainThread]: SQL status: SELECT 2 in 0.018 seconds
[0m14:28:17.365199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199418b0>]}
[0m14:28:17.365541 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:17.365915 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.366125 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.366296 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.366739 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:17.366919 [debug] [MainThread]: On master: Close
[0m14:28:17.369493 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_regions
[0m14:28:17.369853 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_regions ........................ [RUN]
[0m14:28:17.370148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.stg_regions)
[0m14:28:17.370385 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_regions
[0m14:28:17.375605 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_regions"
[0m14:28:17.376097 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_regions
[0m14:28:17.396467 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_regions"
[0m14:28:17.397073 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m14:28:17.397284 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */

  create view "EnterpriseBI"."staging_staging"."stg_regions__dbt_tmp"
    
    
  as (
    select 
    region_name::text as region_name
    active_flag::text as active_flag
    region_code::text as region_code
from "EnterpriseBI"."raw"."regions"
where region_name is not null
  );
[0m14:28:17.397475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:17.411023 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "active_flag"
LINE 9:     active_flag::text as active_flag
            ^

[0m14:28:17.411314 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: ROLLBACK
[0m14:28:17.411680 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: Close
[0m14:28:17.418587 [debug] [Thread-1 (]: Database Error in model stg_regions (models/staging/stg_regions.sql)
  syntax error at or near "active_flag"
  LINE 9:     active_flag::text as active_flag
              ^
  compiled code at target/run/enterprise_bi_project/models/staging/stg_regions.sql
[0m14:28:17.419709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03debde8-0fb7-405b-8752-9ecf8fd28e6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fef290>]}
[0m14:28:17.420094 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging_staging.stg_regions ............... [[31mERROR[0m in 0.05s]
[0m14:28:17.420427 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_regions
[0m14:28:17.420728 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.stg_regions' to be skipped because of status 'error'.  Reason: Database Error in model stg_regions (models/staging/stg_regions.sql)
  syntax error at or near "active_flag"
  LINE 9:     active_flag::text as active_flag
              ^
  compiled code at target/run/enterprise_bi_project/models/staging/stg_regions.sql.
[0m14:28:17.421725 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.421903 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:17.422052 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.422190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:17.436566 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m14:28:17.436863 [debug] [MainThread]: On master: Close
[0m14:28:17.437132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:17.437301 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_regions' was properly closed.
[0m14:28:17.437452 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m14:28:17.437631 [info ] [MainThread]: 
[0m14:28:17.437809 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:28:17.438194 [debug] [MainThread]: Command end result
[0m14:28:17.465434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:28:17.468844 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:28:17.472169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m14:28:17.472353 [info ] [MainThread]: 
[0m14:28:17.472550 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:28:17.472715 [info ] [MainThread]: 
[0m14:28:17.472910 [error] [MainThread]: [31mFailure in model stg_regions (models/staging/stg_regions.sql)[0m
[0m14:28:17.473091 [error] [MainThread]:   Database Error in model stg_regions (models/staging/stg_regions.sql)
  syntax error at or near "active_flag"
  LINE 9:     active_flag::text as active_flag
              ^
  compiled code at target/run/enterprise_bi_project/models/staging/stg_regions.sql
[0m14:28:17.473227 [info ] [MainThread]: 
[0m14:28:17.473393 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/staging/stg_regions.sql
[0m14:28:17.473526 [info ] [MainThread]: 
[0m14:28:17.473679 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:28:17.475458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7709424, "process_in_blocks": "0", "process_kernel_time": 0.216304, "process_mem_max_rss": "126943232", "process_out_blocks": "0", "process_user_time": 1.143962}
[0m14:28:17.475694 [debug] [MainThread]: Command `dbt run` failed at 14:28:17.475649 after 0.77 seconds
[0m14:28:17.475896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119947b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11870bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11870b4d0>]}
[0m14:28:17.476083 [debug] [MainThread]: Flushing usage events
[0m14:28:17.813056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:12.202593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3b9d0>]}


============================== 14:29:12.206288 | c267510f-a823-4f4b-b55f-67e453768a59 ==============================
[0m14:29:12.206288 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:29:12.206653 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select stg_regions', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'profiles_dir': '/Users/bapbap23/.dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'introspect': 'True'}
[0m14:29:12.329265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106054d60>]}
[0m14:29:12.362105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc88d0>]}
[0m14:29:12.362777 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:29:12.417459 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:29:12.505816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:29:12.506438 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_orders_line.sql
[0m14:29:12.506605 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_stores.sql
[0m14:29:12.506756 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_regions.sql
[0m14:29:12.737460 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'stg_orders_line' in package 'enterprise_bi_project'
(models/staging/staging.yml). Arguments to generic tests should be nested under
the `arguments` property.
[0m14:29:12.737801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5e350>]}
[0m14:29:12.792114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4ae40>]}
[0m14:29:12.847818 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:29:12.849522 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:29:12.866011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c9b70>]}
[0m14:29:12.866298 [info ] [MainThread]: Found 11 models, 81 data tests, 5 sources, 464 macros
[0m14:29:12.866485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10824fee0>]}
[0m14:29:12.867771 [info ] [MainThread]: 
[0m14:29:12.867952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:12.868099 [info ] [MainThread]: 
[0m14:29:12.868346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:12.868768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m14:29:12.906209 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m14:29:12.906455 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m14:29:12.906617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:12.954140 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.047 seconds
[0m14:29:12.955108 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m14:29:12.958140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m14:29:12.961696 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m14:29:12.961984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m14:29:12.962193 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:29:12.963258 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m14:29:12.963457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:12.963656 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m14:29:12.963929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:12.980979 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.017 seconds
[0m14:29:12.981302 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.018 seconds
[0m14:29:12.982580 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m14:29:12.983400 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m14:29:12.983750 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m14:29:12.983944 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m14:29:12.987397 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:12.987670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:29:12.987898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:13.005308 [debug] [MainThread]: SQL status: SELECT 2 in 0.017 seconds
[0m14:29:13.006292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e3c50>]}
[0m14:29:13.006633 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:13.006986 [debug] [MainThread]: On master: COMMIT
[0m14:29:13.007317 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:13.007631 [debug] [MainThread]: On master: COMMIT
[0m14:29:13.008011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:13.008207 [debug] [MainThread]: On master: Close
[0m14:29:13.010050 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_regions
[0m14:29:13.010413 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_regions ........................ [RUN]
[0m14:29:13.010723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.stg_regions)
[0m14:29:13.010936 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_regions
[0m14:29:13.015906 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_regions"
[0m14:29:13.016415 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_regions
[0m14:29:13.036557 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_regions"
[0m14:29:13.037102 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m14:29:13.037314 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */

  create view "EnterpriseBI"."staging_staging"."stg_regions__dbt_tmp"
    
    
  as (
    select 
    region_name::text as region_name,
    active_flag::text as active_flag,
    region_code::text as region_code
from "EnterpriseBI"."raw"."regions"
where region_name is not null
  );
[0m14:29:13.037507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:13.056115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m14:29:13.060500 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m14:29:13.060771 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */
alter table "EnterpriseBI"."staging_staging"."stg_regions__dbt_tmp" rename to "stg_regions"
[0m14:29:13.061247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:13.070313 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: COMMIT
[0m14:29:13.070587 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m14:29:13.070787 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: COMMIT
[0m14:29:13.071514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:29:13.074990 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_regions__dbt_backup"
[0m14:29:13.079582 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m14:29:13.079816 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_regions__dbt_backup" cascade
[0m14:29:13.080198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:29:13.081474 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_regions: Close
[0m14:29:13.082593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c267510f-a823-4f4b-b55f-67e453768a59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f2a40>]}
[0m14:29:13.082955 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_regions ................... [[32mCREATE VIEW[0m in 0.07s]
[0m14:29:13.083266 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_regions
[0m14:29:13.083969 [debug] [MainThread]: On master: COMMIT
[0m14:29:13.084152 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:13.084303 [debug] [MainThread]: On master: COMMIT
[0m14:29:13.084446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:13.097865 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m14:29:13.098150 [debug] [MainThread]: On master: Close
[0m14:29:13.098401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:13.098557 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_regions' was properly closed.
[0m14:29:13.098698 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_mart' was properly closed.
[0m14:29:13.098869 [info ] [MainThread]: 
[0m14:29:13.099035 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:29:13.099404 [debug] [MainThread]: Command end result
[0m14:29:13.122956 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:29:13.124176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:29:13.127451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m14:29:13.127647 [info ] [MainThread]: 
[0m14:29:13.127844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:13.127992 [info ] [MainThread]: 
[0m14:29:13.128151 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:29:13.128415 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:29:13.130561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.97012085, "process_in_blocks": "0", "process_kernel_time": 0.201449, "process_mem_max_rss": "132349952", "process_out_blocks": "0", "process_user_time": 1.401356}
[0m14:29:13.130796 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:13.130753 after 0.97 seconds
[0m14:29:13.130980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080aa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e18ad0>]}
[0m14:29:13.131161 [debug] [MainThread]: Flushing usage events
[0m14:29:13.299628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:48.787441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112538590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d79d0>]}


============================== 14:29:48.792481 | bdf59abe-0280-4662-aed4-a9b8fd2e3ff2 ==============================
[0m14:29:48.792481 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:29:48.792870 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/Users/bapbap23/.dbt', 'invocation_command': 'dbt run --select stg_stores', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80'}
[0m14:29:48.911643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e8d60>]}
[0m14:29:48.942463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148648d0>]}
[0m14:29:48.943009 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:29:48.996697 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:29:49.083701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:49.083946 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:29:49.084090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:49.109140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114869950>]}
[0m14:29:49.199354 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:29:49.201174 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:29:49.220023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e8bc50>]}
[0m14:29:49.220314 [info ] [MainThread]: Found 11 models, 81 data tests, 5 sources, 464 macros
[0m14:29:49.220499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e09e10>]}
[0m14:29:49.221794 [info ] [MainThread]: 
[0m14:29:49.221962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:49.222106 [info ] [MainThread]: 
[0m14:29:49.222357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:49.222791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m14:29:49.267014 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m14:29:49.267256 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m14:29:49.267410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:49.316915 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.049 seconds
[0m14:29:49.317901 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m14:29:49.321159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m14:29:49.324750 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m14:29:49.325049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m14:29:49.325276 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m14:29:49.326623 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m14:29:49.326822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:49.327015 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:29:49.327286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:49.352584 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m14:29:49.352904 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.026 seconds
[0m14:29:49.353794 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m14:29:49.354615 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m14:29:49.354924 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m14:29:49.355123 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m14:29:49.358845 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:49.359146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:29:49.359404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:49.378839 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m14:29:49.379836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e3d7e0>]}
[0m14:29:49.380153 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:49.380501 [debug] [MainThread]: On master: COMMIT
[0m14:29:49.380699 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:49.380870 [debug] [MainThread]: On master: COMMIT
[0m14:29:49.381318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:49.381509 [debug] [MainThread]: On master: Close
[0m14:29:49.384022 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_stores
[0m14:29:49.384360 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_stores ......................... [RUN]
[0m14:29:49.384640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.stg_stores)
[0m14:29:49.384860 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_stores
[0m14:29:49.390040 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_stores"
[0m14:29:49.390548 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_stores
[0m14:29:49.410784 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_stores"
[0m14:29:49.411375 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m14:29:49.411581 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */

  create view "EnterpriseBI"."staging_staging"."stg_stores__dbt_tmp"
    
    
  as (
    select 
    store_code::text as store_code,
    store_name::text as store_name,
    city::text as city,
    state::text as state,
    region_name::text as region_name,
    open_date::date as open_date,
    close_date::date as close_date,
    square_feet::float as square_feet
from "EnterpriseBI"."raw"."stores"
where store_code is not null
  );
[0m14:29:49.411777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:49.428664 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:29:49.432916 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m14:29:49.434158 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */
alter table "EnterpriseBI"."staging_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m14:29:49.434692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:49.443663 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_stores: COMMIT
[0m14:29:49.443910 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m14:29:49.444102 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_stores: COMMIT
[0m14:29:49.444789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:29:49.448391 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_stores__dbt_backup"
[0m14:29:49.451510 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m14:29:49.451725 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_stores__dbt_backup" cascade
[0m14:29:49.452142 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:29:49.453523 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_stores: Close
[0m14:29:49.454677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf59abe-0280-4662-aed4-a9b8fd2e3ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115af3410>]}
[0m14:29:49.455035 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_stores .................... [[32mCREATE VIEW[0m in 0.07s]
[0m14:29:49.455329 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_stores
[0m14:29:49.456033 [debug] [MainThread]: On master: COMMIT
[0m14:29:49.456216 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:49.456366 [debug] [MainThread]: On master: COMMIT
[0m14:29:49.456504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:49.470980 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m14:29:49.471282 [debug] [MainThread]: On master: Close
[0m14:29:49.471562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:49.471733 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_stores' was properly closed.
[0m14:29:49.471886 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m14:29:49.472066 [info ] [MainThread]: 
[0m14:29:49.472254 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:29:49.472641 [debug] [MainThread]: Command end result
[0m14:29:49.499929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:29:49.501067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:29:49.504232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m14:29:49.504408 [info ] [MainThread]: 
[0m14:29:49.504605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:49.504758 [info ] [MainThread]: 
[0m14:29:49.504923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:29:49.507074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.76131743, "process_in_blocks": "0", "process_kernel_time": 0.207771, "process_mem_max_rss": "126451712", "process_out_blocks": "0", "process_user_time": 1.160791}
[0m14:29:49.507344 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:49.507289 after 0.76 seconds
[0m14:29:49.507540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e47e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ecbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ecb610>]}
[0m14:29:49.507731 [debug] [MainThread]: Flushing usage events
[0m14:29:49.675202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:02.313513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108efb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108efb9d0>]}


============================== 14:31:02.318940 | e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4 ==============================
[0m14:31:02.318940 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:31:02.319287 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders_line', 'profiles_dir': '/Users/bapbap23/.dbt', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True'}
[0m14:31:02.441243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108210d60>]}
[0m14:31:02.473513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f888d0>]}
[0m14:31:02.474251 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:31:02.532406 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:31:02.625329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:31:02.625595 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:31:02.625749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:31:02.652069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8d950>]}
[0m14:31:02.747554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:31:02.749133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:31:02.766391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7bc50>]}
[0m14:31:02.766705 [info ] [MainThread]: Found 11 models, 81 data tests, 5 sources, 464 macros
[0m14:31:02.766897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109651e10>]}
[0m14:31:02.768203 [info ] [MainThread]: 
[0m14:31:02.768378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:02.768521 [info ] [MainThread]: 
[0m14:31:02.768786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:02.769218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m14:31:02.815212 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m14:31:02.815465 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m14:31:02.815627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:02.865877 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m14:31:02.866676 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m14:31:02.869332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m14:31:02.872339 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m14:31:02.872539 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m14:31:02.872708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:02.873034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m14:31:02.874236 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m14:31:02.874433 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:31:02.874674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:02.887998 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.015 seconds
[0m14:31:02.888296 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m14:31:02.889016 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m14:31:02.889669 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m14:31:02.889918 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m14:31:02.890088 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m14:31:02.893146 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:02.893413 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:31:02.893612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:02.907608 [debug] [MainThread]: SQL status: SELECT 4 in 0.014 seconds
[0m14:31:02.908450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3918b0>]}
[0m14:31:02.908728 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:02.909048 [debug] [MainThread]: On master: COMMIT
[0m14:31:02.909241 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:02.909392 [debug] [MainThread]: On master: COMMIT
[0m14:31:02.909783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:02.909928 [debug] [MainThread]: On master: Close
[0m14:31:02.911626 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_orders_line
[0m14:31:02.911905 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_orders_line .................... [RUN]
[0m14:31:02.912141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.stg_orders_line)
[0m14:31:02.912325 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_orders_line
[0m14:31:02.916702 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_orders_line"
[0m14:31:02.917159 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_orders_line
[0m14:31:02.936121 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_orders_line"
[0m14:31:02.936703 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m14:31:02.936926 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */

  create view "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_tmp"
    
    
  as (
    

select
  order_code::text        as order_id,
  line_number::int        as line_number,

  store_code::text        as store_id,
  customer_code::text     as customer_id,
  product_code::text      as product_id,

  order_ts::date          as order_date,
  delivery_ts::date       as delivery_date,

  order_type::text        as order_type,
  order_status::text      as order_status,

  quantity::int           as quantity,
  unit_price::numeric     as unit_price,
  unit_cost::numeric      as unit_cost,

  (quantity::numeric * unit_price::numeric) as line_revenue,
  (quantity::numeric * unit_cost::numeric)  as line_cost,
  (quantity::numeric * (unit_price::numeric - unit_cost::numeric)) as line_margin

from "EnterpriseBI"."raw"."orders"
where order_code is not null
  and line_number is not null;
  );
[0m14:31:02.937122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:02.950688 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 33:   and line_number is not null;
                                      ^

[0m14:31:02.950969 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: ROLLBACK
[0m14:31:02.951348 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: Close
[0m14:31:02.957994 [debug] [Thread-1 (]: Database Error in model stg_orders_line (models/staging/stg_orders_line.sql)
  syntax error at or near ";"
  LINE 33:   and line_number is not null;
                                        ^
  compiled code at target/run/enterprise_bi_project/models/staging/stg_orders_line.sql
[0m14:31:02.959140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e00bd8ad-d7be-4b53-96b5-9aa6f6603ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a143290>]}
[0m14:31:02.959506 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging_staging.stg_orders_line ........... [[31mERROR[0m in 0.05s]
[0m14:31:02.959820 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_orders_line
[0m14:31:02.960097 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.stg_orders_line' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders_line (models/staging/stg_orders_line.sql)
  syntax error at or near ";"
  LINE 33:   and line_number is not null;
                                        ^
  compiled code at target/run/enterprise_bi_project/models/staging/stg_orders_line.sql.
[0m14:31:02.961081 [debug] [MainThread]: On master: COMMIT
[0m14:31:02.961255 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:02.961399 [debug] [MainThread]: On master: COMMIT
[0m14:31:02.961531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:02.974007 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m14:31:02.974284 [debug] [MainThread]: On master: Close
[0m14:31:02.974535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:02.974687 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_orders_line' was properly closed.
[0m14:31:02.974820 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m14:31:02.975148 [info ] [MainThread]: 
[0m14:31:02.975361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:31:02.975742 [debug] [MainThread]: Command end result
[0m14:31:03.001129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:31:03.002259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:31:03.005523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m14:31:03.005713 [info ] [MainThread]: 
[0m14:31:03.005929 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:31:03.006090 [info ] [MainThread]: 
[0m14:31:03.006285 [error] [MainThread]: [31mFailure in model stg_orders_line (models/staging/stg_orders_line.sql)[0m
[0m14:31:03.006470 [error] [MainThread]:   Database Error in model stg_orders_line (models/staging/stg_orders_line.sql)
  syntax error at or near ";"
  LINE 33:   and line_number is not null;
                                        ^
  compiled code at target/run/enterprise_bi_project/models/staging/stg_orders_line.sql
[0m14:31:03.006608 [info ] [MainThread]: 
[0m14:31:03.006780 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/staging/stg_orders_line.sql
[0m14:31:03.006914 [info ] [MainThread]: 
[0m14:31:03.007063 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:31:03.009422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73876023, "process_in_blocks": "0", "process_kernel_time": 0.211599, "process_mem_max_rss": "126386176", "process_out_blocks": "0", "process_user_time": 1.153713}
[0m14:31:03.009752 [debug] [MainThread]: Command `dbt run` failed at 14:31:03.009692 after 0.74 seconds
[0m14:31:03.009962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a39bb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a173930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a173a70>]}
[0m14:31:03.010155 [debug] [MainThread]: Flushing usage events
[0m14:31:03.162959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:42.053796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924b9d0>]}


============================== 14:31:42.057475 | c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07 ==============================
[0m14:31:42.057475 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:31:42.057814 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select stg_orders_line', 'target_path': 'None', 'write_json': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'warn_error': 'None', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/Users/bapbap23/.dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m14:31:42.181662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108564d60>]}
[0m14:31:42.214891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d88d0>]}
[0m14:31:42.215490 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m14:31:42.268701 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:31:42.366266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:31:42.366774 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/staging/stg_orders_line.sql
[0m14:31:42.593188 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`
defined on 'stg_orders_line' in package 'enterprise_bi_project'
(models/staging/staging.yml). Arguments to generic tests should be nested under
the `arguments` property.
[0m14:31:42.593510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a37e250>]}
[0m14:31:42.638229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25b4d0>]}
[0m14:31:42.693500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:31:42.694873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:31:42.711582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a565630>]}
[0m14:31:42.711858 [info ] [MainThread]: Found 11 models, 81 data tests, 5 sources, 464 macros
[0m14:31:42.712041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a74fee0>]}
[0m14:31:42.713305 [info ] [MainThread]: 
[0m14:31:42.713490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:42.713634 [info ] [MainThread]: 
[0m14:31:42.713883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:42.714311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m14:31:42.758100 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m14:31:42.758359 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m14:31:42.758509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:42.830470 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.072 seconds
[0m14:31:42.831595 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m14:31:42.835417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m14:31:42.835778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m14:31:42.839472 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m14:31:42.840646 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m14:31:42.840885 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:31:42.841126 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m14:31:42.841327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:42.841499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:42.863606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.022 seconds
[0m14:31:42.863923 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m14:31:42.865225 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m14:31:42.866079 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m14:31:42.866436 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m14:31:42.866625 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m14:31:42.870235 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.870512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:31:42.870741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:42.888010 [debug] [MainThread]: SQL status: SELECT 4 in 0.017 seconds
[0m14:31:42.889014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6fbb90>]}
[0m14:31:42.889336 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:42.889627 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.889816 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.889993 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.890500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:42.890681 [debug] [MainThread]: On master: Close
[0m14:31:42.892529 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_orders_line
[0m14:31:42.892876 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_orders_line .................... [RUN]
[0m14:31:42.893154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.stg_orders_line)
[0m14:31:42.893377 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_orders_line
[0m14:31:42.898856 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_orders_line"
[0m14:31:42.899370 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_orders_line
[0m14:31:42.919860 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_orders_line"
[0m14:31:42.920413 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m14:31:42.920638 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */

  create view "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_tmp"
    
    
  as (
    

select
  order_code::text        as order_id,
  line_number::int        as line_number,

  store_code::text        as store_id,
  customer_code::text     as customer_id,
  product_code::text      as product_id,

  order_ts::date          as order_date,
  delivery_ts::date       as delivery_date,

  order_type::text        as order_type,
  order_status::text      as order_status,

  quantity::int           as quantity,
  unit_price::numeric     as unit_price,
  unit_cost::numeric      as unit_cost,

  (quantity::numeric * unit_price::numeric) as line_revenue,
  (quantity::numeric * unit_cost::numeric)  as line_cost,
  (quantity::numeric * (unit_price::numeric - unit_cost::numeric)) as line_margin

from "EnterpriseBI"."raw"."orders"
where order_code is not null
  and line_number is not null
  );
[0m14:31:42.920845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:42.938460 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m14:31:42.942737 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m14:31:42.943003 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */
alter table "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_tmp" rename to "stg_orders_line"
[0m14:31:42.943514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:31:42.952326 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: COMMIT
[0m14:31:42.952585 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m14:31:42.952789 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: COMMIT
[0m14:31:42.953925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:31:42.957442 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_backup"
[0m14:31:42.960514 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m14:31:42.960747 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_backup" cascade
[0m14:31:42.961159 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:31:42.962492 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_orders_line: Close
[0m14:31:42.963745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1ed4dc7-ae57-4f1d-a494-d42a1d91ff07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5fac50>]}
[0m14:31:42.964103 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_orders_line ............... [[32mCREATE VIEW[0m in 0.07s]
[0m14:31:42.964415 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_orders_line
[0m14:31:42.965068 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.965245 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.965495 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.965659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:42.979240 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m14:31:42.979545 [debug] [MainThread]: On master: Close
[0m14:31:42.979814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:42.979979 [debug] [MainThread]: Connection 'model.enterprise_bi_project.stg_orders_line' was properly closed.
[0m14:31:42.980123 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_mart' was properly closed.
[0m14:31:42.980297 [info ] [MainThread]: 
[0m14:31:42.980471 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:31:42.980846 [debug] [MainThread]: Command end result
[0m14:31:43.021034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m14:31:43.022327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m14:31:43.025826 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m14:31:43.026019 [info ] [MainThread]: 
[0m14:31:43.026240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:43.026408 [info ] [MainThread]: 
[0m14:31:43.026588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:31:43.026877 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:31:43.029118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0219563, "process_in_blocks": "0", "process_kernel_time": 0.210157, "process_mem_max_rss": "131022848", "process_out_blocks": "0", "process_user_time": 1.382116}
[0m14:31:43.029370 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:43.029325 after 1.02 seconds
[0m14:31:43.029570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9afe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a62fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a328ad0>]}
[0m14:31:43.029779 [debug] [MainThread]: Flushing usage events
[0m14:31:43.212042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:22.207107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109463890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094639d0>]}


============================== 15:28:22.211553 | c28ee509-b08d-44ad-8389-0a4760232687 ==============================
[0m15:28:22.211553 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:28:22.211914 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'quiet': 'False', 'invocation_command': 'dbt run --select dim_date', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/bapbap23/.dbt', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m15:28:22.331824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c28ee509-b08d-44ad-8389-0a4760232687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774d60>]}
[0m15:28:22.363106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c28ee509-b08d-44ad-8389-0a4760232687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f08d0>]}
[0m15:28:22.363803 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:28:22.421445 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:28:22.511948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m15:28:22.512423 [debug] [MainThread]: Partial parsing: added file: enterprise_bi_project://models/marts/facts/fact_orders.yml
[0m15:28:22.512828 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/facts/fact_orders.sql
[0m15:28:22.512989 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m15:28:22.513134 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_region.sql
[0m15:28:22.513338 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_product.sql
[0m15:28:22.513494 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/facts/fact_orders.sql
[0m15:28:22.513641 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m15:28:22.513854 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_date.sql
[0m15:28:22.729548 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fact_orders' in
package 'enterprise_bi_project' (models/marts/facts/fact_orders.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m15:28:22.729855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c28ee509-b08d-44ad-8389-0a4760232687', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f7a50>]}
[0m15:28:22.747587 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named fact_orders. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for fact_orders in one of these files:
   - models/marts/marts.yml
  models/marts/facts/fact_orders.yml
[0m15:28:22.747988 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:28:22.750457 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5875292, "process_in_blocks": "0", "process_kernel_time": 0.193136, "process_mem_max_rss": "118767616", "process_out_blocks": "0", "process_user_time": 1.161337}
[0m15:28:22.750797 [debug] [MainThread]: Command `dbt run` failed at 15:28:22.750742 after 0.59 seconds
[0m15:28:22.751008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943be70>]}
[0m15:28:22.751203 [debug] [MainThread]: Flushing usage events
[0m15:28:22.966412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:41.461992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103db0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c4b9d0>]}


============================== 15:29:41.466729 | 9d4b2492-d6e8-4d73-b80c-69f4280f76dd ==============================
[0m15:29:41.466729 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:29:41.467151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt parse', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/bapbap23/.dbt'}
[0m15:29:41.584670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d4b2492-d6e8-4d73-b80c-69f4280f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f60d60>]}
[0m15:29:41.615975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d4b2492-d6e8-4d73-b80c-69f4280f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdc8d0>]}
[0m15:29:41.616585 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:29:41.673732 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:29:41.763227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 6 files changed.
[0m15:29:41.763713 [debug] [MainThread]: Partial parsing: added file: enterprise_bi_project://models/marts/facts/fact_orders.yml
[0m15:29:41.764105 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/marts.yml
[0m15:29:41.764372 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_date.sql
[0m15:29:41.764607 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m15:29:41.764832 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_region.sql
[0m15:29:41.764992 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/facts/fact_orders.sql
[0m15:29:41.765203 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_product.sql
[0m15:29:42.071491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4b2492-d6e8-4d73-b80c-69f4280f76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75550>]}
[0m15:29:42.073783 [info ] [MainThread]: Performance info: /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/perf_info.json
[0m15:29:42.129080 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:29:42.130662 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:29:42.132869 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.7155544, "process_in_blocks": "0", "process_kernel_time": 0.180909, "process_mem_max_rss": "123879424", "process_out_blocks": "0", "process_user_time": 1.280814}
[0m15:29:42.133146 [debug] [MainThread]: Command `dbt parse` succeeded at 15:29:42.133094 after 0.72 seconds
[0m15:29:42.133337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a45ef0>]}
[0m15:29:42.133525 [debug] [MainThread]: Flushing usage events
[0m15:29:42.330783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:51.378972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104324590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bf9d0>]}


============================== 15:29:51.382368 | bdda241b-58c5-4ee0-99aa-95527c74903d ==============================
[0m15:29:51.382368 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:29:51.382727 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'quiet': 'False', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'printer_width': '80', 'profiles_dir': '/Users/bapbap23/.dbt', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_orders', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False'}
[0m15:29:51.487219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d0d60>]}
[0m15:29:51.518365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524c8d0>]}
[0m15:29:51.519360 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:29:51.576054 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:29:51.659333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:51.659576 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:29:51.659720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:51.684894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105251950>]}
[0m15:29:51.773240 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:29:51.774691 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:29:51.792048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4bc50>]}
[0m15:29:51.792325 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m15:29:51.792508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105917d90>]}
[0m15:29:51.793735 [info ] [MainThread]: 
[0m15:29:51.793914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:51.794058 [info ] [MainThread]: 
[0m15:29:51.794314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:51.794743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m15:29:51.842038 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m15:29:51.842286 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m15:29:51.842439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:51.918655 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.076 seconds
[0m15:29:51.919673 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m15:29:51.920163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now create_EnterpriseBI_staging_mart)
[0m15:29:51.920491 [debug] [ThreadPool]: Creating schema "database: "EnterpriseBI"
schema: "staging_mart"
"
[0m15:29:51.924012 [debug] [ThreadPool]: Using postgres connection "create_EnterpriseBI_staging_mart"
[0m15:29:51.924238 [debug] [ThreadPool]: On create_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "create_EnterpriseBI_staging_mart"} */
create schema if not exists "staging_mart"
[0m15:29:51.924421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:51.945599 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.021 seconds
[0m15:29:51.946341 [debug] [ThreadPool]: On create_EnterpriseBI_staging_mart: COMMIT
[0m15:29:51.946560 [debug] [ThreadPool]: Using postgres connection "create_EnterpriseBI_staging_mart"
[0m15:29:51.946740 [debug] [ThreadPool]: On create_EnterpriseBI_staging_mart: COMMIT
[0m15:29:51.947492 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:29:51.947688 [debug] [ThreadPool]: On create_EnterpriseBI_staging_mart: Close
[0m15:29:51.951127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_EnterpriseBI_staging_mart, now list_EnterpriseBI_staging_staging)
[0m15:29:51.951524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m15:29:51.955665 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m15:29:51.956879 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m15:29:51.957130 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:29:51.957460 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m15:29:51.957656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:51.957821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:51.976825 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m15:29:51.977143 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m15:29:51.978014 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m15:29:51.978842 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m15:29:51.979159 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m15:29:51.979356 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m15:29:51.983080 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:51.983369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:29:51.983604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:52.006654 [debug] [MainThread]: SQL status: SELECT 5 in 0.023 seconds
[0m15:29:52.008043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106639d90>]}
[0m15:29:52.008432 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:52.008776 [debug] [MainThread]: On master: COMMIT
[0m15:29:52.009017 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:52.009211 [debug] [MainThread]: On master: COMMIT
[0m15:29:52.009558 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:52.009744 [debug] [MainThread]: On master: Close
[0m15:29:52.011656 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.fact_orders
[0m15:29:52.012030 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.fact_orders .......................... [RUN]
[0m15:29:52.012341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.fact_orders)
[0m15:29:52.012579 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.fact_orders
[0m15:29:52.018471 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.fact_orders"
[0m15:29:52.019551 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.fact_orders
[0m15:29:52.043032 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.fact_orders"
[0m15:29:52.043737 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m15:29:52.043969 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

with lines as (
    select
        order_code,
        customer_code,
        store_code,

        order_ts,
        delivery_ts,
        order_status,
        order_type,

        quantity,
        unit_price,
        unit_cost
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
)

select
    order_code,

    -- dimensions / keys for slicing
    customer_code,
    store_code,

    -- timestamps (choose a rule; min/max is safe)
    min(order_ts)    as order_ts,
    max(delivery_ts) as delivery_ts,

    -- order-level metrics (sum across lines)
    sum(quantity * unit_price)                        as order_revenue,
    sum(quantity * unit_cost)                         as order_cost,
    sum(quantity * (unit_price - unit_cost))          as order_margin,
    count(*)                                          as line_count,
    sum(quantity)                                     as total_units,

    -- status/type: if consistent per order, max() is fine
    max(order_status) as order_status,
    max(order_type)   as order_type

from lines
group by 1,2,3
  );
  
[0m15:29:52.044178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:52.061192 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_code" does not exist
LINE 16:         order_code,
                 ^

[0m15:29:52.061520 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: ROLLBACK
[0m15:29:52.061911 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: Close
[0m15:29:52.070055 [debug] [Thread-1 (]: Database Error in model fact_orders (models/marts/facts/fact_orders.sql)
  column "order_code" does not exist
  LINE 16:         order_code,
                   ^
  compiled code at target/run/enterprise_bi_project/models/marts/facts/fact_orders.sql
[0m15:29:52.071363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdda241b-58c5-4ee0-99aa-95527c74903d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061525d0>]}
[0m15:29:52.071782 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging_mart.fact_orders ................. [[31mERROR[0m in 0.06s]
[0m15:29:52.072125 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.fact_orders
[0m15:29:52.072429 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.fact_orders' to be skipped because of status 'error'.  Reason: Database Error in model fact_orders (models/marts/facts/fact_orders.sql)
  column "order_code" does not exist
  LINE 16:         order_code,
                   ^
  compiled code at target/run/enterprise_bi_project/models/marts/facts/fact_orders.sql.
[0m15:29:52.073408 [debug] [MainThread]: On master: COMMIT
[0m15:29:52.073601 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:52.073769 [debug] [MainThread]: On master: COMMIT
[0m15:29:52.073919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:52.087807 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:29:52.088088 [debug] [MainThread]: On master: Close
[0m15:29:52.088350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:52.088511 [debug] [MainThread]: Connection 'model.enterprise_bi_project.fact_orders' was properly closed.
[0m15:29:52.088655 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_mart' was properly closed.
[0m15:29:52.088824 [info ] [MainThread]: 
[0m15:29:52.088998 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:29:52.089372 [debug] [MainThread]: Command end result
[0m15:29:52.114135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:29:52.115551 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:29:52.119787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m15:29:52.119998 [info ] [MainThread]: 
[0m15:29:52.120193 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:29:52.120355 [info ] [MainThread]: 
[0m15:29:52.120552 [error] [MainThread]: [31mFailure in model fact_orders (models/marts/facts/fact_orders.sql)[0m
[0m15:29:52.120732 [error] [MainThread]:   Database Error in model fact_orders (models/marts/facts/fact_orders.sql)
  column "order_code" does not exist
  LINE 16:         order_code,
                   ^
  compiled code at target/run/enterprise_bi_project/models/marts/facts/fact_orders.sql
[0m15:29:52.120872 [info ] [MainThread]: 
[0m15:29:52.121032 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/marts/facts/fact_orders.sql
[0m15:29:52.121164 [info ] [MainThread]: 
[0m15:29:52.121318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:52.123422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7858325, "process_in_blocks": "0", "process_kernel_time": 0.206626, "process_mem_max_rss": "125616128", "process_out_blocks": "0", "process_user_time": 1.179697}
[0m15:29:52.123656 [debug] [MainThread]: Command `dbt run` failed at 15:29:52.123612 after 0.79 seconds
[0m15:29:52.123849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066fb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106423e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106423610>]}
[0m15:29:52.124023 [debug] [MainThread]: Flushing usage events
[0m15:29:52.288550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:54.680185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107177890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071779d0>]}


============================== 15:30:54.688595 | 63340b55-17d0-4d1e-baa2-471b150ed577 ==============================
[0m15:30:54.688595 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:30:54.688955 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/bapbap23/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select dim_date'}
[0m15:30:54.812770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106488d60>]}
[0m15:30:54.844038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072048d0>]}
[0m15:30:54.844671 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:30:54.899587 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:30:54.988457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:54.988951 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/facts/fact_orders.sql
[0m15:30:55.251861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bd950>]}
[0m15:30:55.305512 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:30:55.306938 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:30:55.323072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f35400>]}
[0m15:30:55.323363 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m15:30:55.323547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e67b0>]}
[0m15:30:55.324802 [info ] [MainThread]: 
[0m15:30:55.324990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:30:55.325135 [info ] [MainThread]: 
[0m15:30:55.325381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:55.325806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m15:30:55.420943 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m15:30:55.424396 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m15:30:55.425155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:55.550960 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.126 seconds
[0m15:30:55.552180 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m15:30:55.555907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m15:30:55.558918 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m15:30:55.559161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m15:30:55.559357 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m15:30:55.560225 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m15:30:55.560387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:55.560555 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:30:55.560809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:55.576463 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m15:30:55.576757 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m15:30:55.578051 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m15:30:55.578756 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m15:30:55.579039 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m15:30:55.579219 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m15:30:55.582746 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:55.583052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:30:55.583276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:55.598365 [debug] [MainThread]: SQL status: SELECT 5 in 0.015 seconds
[0m15:30:55.599377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108514c80>]}
[0m15:30:55.599729 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:55.600089 [debug] [MainThread]: On master: COMMIT
[0m15:30:55.600289 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:55.600471 [debug] [MainThread]: On master: COMMIT
[0m15:30:55.600891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:55.601124 [debug] [MainThread]: On master: Close
[0m15:30:55.603734 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.dim_date
[0m15:30:55.604118 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.dim_date ............................. [RUN]
[0m15:30:55.604478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.dim_date)
[0m15:30:55.604701 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.dim_date
[0m15:30:55.609798 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_date"
[0m15:30:55.610389 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.dim_date
[0m15:30:55.633968 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_date"
[0m15:30:55.634630 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m15:30:55.634864 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    select
        min(order_ts::date) as start_date,
        max(order_ts::date) as end_date
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
),

date_spine as (
    select generate_series(
        (select start_date from bounds),
        (select end_date from bounds),
        interval '1 day'
    )::date as date_day
)

select
    date_day,

    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon') as month_name,

    to_char(date_day, 'YYYY-MM') as year_month,

    extract(quarter from date_day)::int as quarter,
    extract(week from date_day)::int as week_of_year,

    extract(day from date_day)::int as day_of_month,
    to_char(date_day, 'Dy') as day_name,

    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
from date_spine
order by date_day;
  );
  
[0m15:30:55.635070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:55.650010 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 46: order by date_day;
                          ^

[0m15:30:55.650293 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: ROLLBACK
[0m15:30:55.650621 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: Close
[0m15:30:55.659951 [debug] [Thread-1 (]: Database Error in model dim_date (models/marts/dimensions/dim_date.sql)
  syntax error at or near ";"
  LINE 46: order by date_day;
                            ^
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_date.sql
[0m15:30:55.661882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63340b55-17d0-4d1e-baa2-471b150ed577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a284d0>]}
[0m15:30:55.662704 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging_mart.dim_date .................... [[31mERROR[0m in 0.06s]
[0m15:30:55.663063 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.dim_date
[0m15:30:55.663383 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models/marts/dimensions/dim_date.sql)
  syntax error at or near ";"
  LINE 46: order by date_day;
                            ^
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_date.sql.
[0m15:30:55.664509 [debug] [MainThread]: On master: COMMIT
[0m15:30:55.664699 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:55.664852 [debug] [MainThread]: On master: COMMIT
[0m15:30:55.664996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:55.678266 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:30:55.678567 [debug] [MainThread]: On master: Close
[0m15:30:55.678836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:55.679005 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_date' was properly closed.
[0m15:30:55.679160 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m15:30:55.679338 [info ] [MainThread]: 
[0m15:30:55.679522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:30:55.679909 [debug] [MainThread]: Command end result
[0m15:30:55.705332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:30:55.706506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:30:55.709604 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m15:30:55.709776 [info ] [MainThread]: 
[0m15:30:55.709981 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:30:55.710148 [info ] [MainThread]: 
[0m15:30:55.710347 [error] [MainThread]: [31mFailure in model dim_date (models/marts/dimensions/dim_date.sql)[0m
[0m15:30:55.710592 [error] [MainThread]:   Database Error in model dim_date (models/marts/dimensions/dim_date.sql)
  syntax error at or near ";"
  LINE 46: order by date_day;
                            ^
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_date.sql
[0m15:30:55.710788 [info ] [MainThread]: 
[0m15:30:55.711037 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/marts/dimensions/dim_date.sql
[0m15:30:55.711234 [info ] [MainThread]: 
[0m15:30:55.711428 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:30:55.713360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0742061, "process_in_blocks": "0", "process_kernel_time": 0.222294, "process_mem_max_rss": "128794624", "process_out_blocks": "0", "process_user_time": 1.348885}
[0m15:30:55.713639 [debug] [MainThread]: Command `dbt run` failed at 15:30:55.713587 after 1.07 seconds
[0m15:30:55.713845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ffee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b2350>]}
[0m15:30:55.714038 [debug] [MainThread]: Flushing usage events
[0m15:30:55.898275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:17.605545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b79d0>]}


============================== 15:31:17.609011 | 028e4e03-e2fc-402b-b56b-7ebcf6262733 ==============================
[0m15:31:17.609011 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:31:17.609371 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select fact_orders', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'profiles_dir': '/Users/bapbap23/.dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'empty': 'False', 'version_check': 'True', 'target_path': 'None'}
[0m15:31:17.723387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d0d60>]}
[0m15:31:17.754817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071448d0>]}
[0m15:31:17.755823 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:31:17.811724 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:31:17.895988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:17.896506 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_date.sql
[0m15:31:18.165767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c2550>]}
[0m15:31:18.220944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:31:18.222575 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:31:18.237862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2d400>]}
[0m15:31:18.238162 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m15:31:18.238348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eac2f0>]}
[0m15:31:18.239584 [info ] [MainThread]: 
[0m15:31:18.239766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:18.239911 [info ] [MainThread]: 
[0m15:31:18.240157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:18.240572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m15:31:18.274000 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m15:31:18.274272 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m15:31:18.274435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:18.323758 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.049 seconds
[0m15:31:18.324689 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m15:31:18.327776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m15:31:18.331561 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m15:31:18.331855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m15:31:18.332073 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m15:31:18.333215 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m15:31:18.333402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:18.333598 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:31:18.333865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:18.351015 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m15:31:18.351326 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m15:31:18.352625 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m15:31:18.353478 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m15:31:18.353823 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m15:31:18.354021 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m15:31:18.357698 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:18.357986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:31:18.358238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:18.374389 [debug] [MainThread]: SQL status: SELECT 5 in 0.016 seconds
[0m15:31:18.375386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871e750>]}
[0m15:31:18.375699 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:18.376028 [debug] [MainThread]: On master: COMMIT
[0m15:31:18.376219 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:18.376393 [debug] [MainThread]: On master: COMMIT
[0m15:31:18.376779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:18.376960 [debug] [MainThread]: On master: Close
[0m15:31:18.378793 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.fact_orders
[0m15:31:18.379310 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.fact_orders .......................... [RUN]
[0m15:31:18.379616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.fact_orders)
[0m15:31:18.379856 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.fact_orders
[0m15:31:18.385909 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.fact_orders"
[0m15:31:18.386683 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.fact_orders
[0m15:31:18.408449 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.fact_orders"
[0m15:31:18.409225 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m15:31:18.409478 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

with lines as (
    select
        order_id      as order_code,
        customer_id   as customer_code,
        store_id      as store_code,

        order_date    as order_ts,
        delivery_date as delivery_ts,
        order_status,
        order_type,

        quantity,
        unit_price,
        unit_cost
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
)

select
    order_code,

    -- dimensions / keys for slicing
    customer_code,
    store_code,

    -- timestamps (choose a rule; min/max is safe)
    min(order_ts)    as order_ts,
    max(delivery_ts) as delivery_ts,

    -- order-level metrics (sum across lines)
    sum(quantity * unit_price)                        as order_revenue,
    sum(quantity * unit_cost)                         as order_cost,
    sum(quantity * (unit_price - unit_cost))          as order_margin,
    count(*)                                          as line_count,
    sum(quantity)                                     as total_units,

    -- status/type: if consistent per order, max() is fine
    max(order_status) as order_status,
    max(order_type)   as order_type

from lines
group by 1,2,3
  );
  
[0m15:31:18.409692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:19.900315 [debug] [Thread-1 (]: SQL status: SELECT 193079 in 1.490 seconds
[0m15:31:19.918919 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m15:31:19.919606 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
alter table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m15:31:19.926937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:31:19.935957 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: COMMIT
[0m15:31:19.936465 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m15:31:19.936881 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: COMMIT
[0m15:31:19.939753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:31:19.943017 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."fact_orders__dbt_backup"
[0m15:31:19.945748 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m15:31:19.946216 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
drop table if exists "EnterpriseBI"."staging_mart"."fact_orders__dbt_backup" cascade
[0m15:31:19.946849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:31:19.948295 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: Close
[0m15:31:19.949699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028e4e03-e2fc-402b-b56b-7ebcf6262733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896c650>]}
[0m15:31:19.950120 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging_mart.fact_orders ..................... [[32mSELECT 193079[0m in 1.57s]
[0m15:31:19.950458 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.fact_orders
[0m15:31:19.951256 [debug] [MainThread]: On master: COMMIT
[0m15:31:19.951429 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:19.951576 [debug] [MainThread]: On master: COMMIT
[0m15:31:19.951716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:19.965659 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:31:19.965944 [debug] [MainThread]: On master: Close
[0m15:31:19.966203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:19.966354 [debug] [MainThread]: Connection 'model.enterprise_bi_project.fact_orders' was properly closed.
[0m15:31:19.966488 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m15:31:19.966701 [info ] [MainThread]: 
[0m15:31:19.966912 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m15:31:19.967298 [debug] [MainThread]: Command end result
[0m15:31:19.995984 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:31:19.997609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:31:20.002693 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m15:31:20.002983 [info ] [MainThread]: 
[0m15:31:20.003240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:20.003437 [info ] [MainThread]: 
[0m15:31:20.003657 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:31:20.005996 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.440054, "process_in_blocks": "0", "process_kernel_time": 0.212019, "process_mem_max_rss": "131072000", "process_out_blocks": "0", "process_user_time": 1.394472}
[0m15:31:20.006365 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:20.006302 after 2.44 seconds
[0m15:31:20.006637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108537ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893bb10>]}
[0m15:31:20.006884 [debug] [MainThread]: Flushing usage events
[0m15:31:20.378812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:31.389392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d43890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d439d0>]}


============================== 15:31:31.392914 | 3851efa8-41f9-4f86-be28-a7d206d72688 ==============================
[0m15:31:31.392914 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:31:31.393263 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/Users/bapbap23/.dbt', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_date'}
[0m15:31:31.506704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104050d60>]}
[0m15:31:31.539485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd08d0>]}
[0m15:31:31.540249 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:31:31.596938 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:31:31.680674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:31.680920 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:31:31.681079 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:31.706275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd5950>]}
[0m15:31:31.796267 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:31:31.798010 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:31:31.813811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b03c50>]}
[0m15:31:31.814090 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m15:31:31.814270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549bd90>]}
[0m15:31:31.815592 [info ] [MainThread]: 
[0m15:31:31.815797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:31.815948 [info ] [MainThread]: 
[0m15:31:31.816213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:31.816656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m15:31:31.850985 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m15:31:31.851237 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m15:31:31.851398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:31.900044 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.049 seconds
[0m15:31:31.900974 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m15:31:31.904056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m15:31:31.907736 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m15:31:31.908051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m15:31:31.908303 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m15:31:31.909704 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m15:31:31.909908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:31.910109 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:31:31.910381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:31.932939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.023 seconds
[0m15:31:31.933259 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m15:31:31.934199 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m15:31:31.935028 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m15:31:31.935749 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m15:31:31.935977 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m15:31:31.939807 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:31.940105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:31:31.940336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:31.957179 [debug] [MainThread]: SQL status: SELECT 5 in 0.017 seconds
[0m15:31:31.958194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bd4a0>]}
[0m15:31:31.958531 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:31.958847 [debug] [MainThread]: On master: COMMIT
[0m15:31:31.959037 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:31.959210 [debug] [MainThread]: On master: COMMIT
[0m15:31:31.959539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:31.959714 [debug] [MainThread]: On master: Close
[0m15:31:31.961485 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.dim_date
[0m15:31:31.961828 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.dim_date ............................. [RUN]
[0m15:31:31.962104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.dim_date)
[0m15:31:31.962326 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.dim_date
[0m15:31:31.967872 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_date"
[0m15:31:31.968653 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.dim_date
[0m15:31:31.991019 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_date"
[0m15:31:31.991712 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m15:31:31.991936 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    select
        min(order_ts::date) as start_date,
        max(order_ts::date) as end_date
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
),

date_spine as (
    select generate_series(
        (select start_date from bounds),
        (select end_date from bounds),
        interval '1 day'
    )::date as date_day
)

select
    date_day,

    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon') as month_name,

    to_char(date_day, 'YYYY-MM') as year_month,

    extract(quarter from date_day)::int as quarter,
    extract(week from date_day)::int as week_of_year,

    extract(day from date_day)::int as day_of_month,
    to_char(date_day, 'Dy') as day_name,

    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
from date_spine
order by date_day
  );
  
[0m15:31:31.992141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:32.006867 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_ts" does not exist
LINE 16:         min(order_ts::date) as start_date,
                     ^
HINT:  Perhaps you meant to reference the column "stg_orders_line.order_id".

[0m15:31:32.007191 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: ROLLBACK
[0m15:31:32.007583 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: Close
[0m15:31:32.014537 [debug] [Thread-1 (]: Database Error in model dim_date (models/marts/dimensions/dim_date.sql)
  column "order_ts" does not exist
  LINE 16:         min(order_ts::date) as start_date,
                       ^
  HINT:  Perhaps you meant to reference the column "stg_orders_line.order_id".
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_date.sql
[0m15:31:32.015876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3851efa8-41f9-4f86-be28-a7d206d72688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8f110>]}
[0m15:31:32.016298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging_mart.dim_date .................... [[31mERROR[0m in 0.05s]
[0m15:31:32.016638 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.dim_date
[0m15:31:32.016951 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models/marts/dimensions/dim_date.sql)
  column "order_ts" does not exist
  LINE 16:         min(order_ts::date) as start_date,
                       ^
  HINT:  Perhaps you meant to reference the column "stg_orders_line.order_id".
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_date.sql.
[0m15:31:32.017958 [debug] [MainThread]: On master: COMMIT
[0m15:31:32.018141 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:32.018293 [debug] [MainThread]: On master: COMMIT
[0m15:31:32.018438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:32.031326 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:31:32.031631 [debug] [MainThread]: On master: Close
[0m15:31:32.031970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:32.032320 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_date' was properly closed.
[0m15:31:32.032529 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m15:31:32.032732 [info ] [MainThread]: 
[0m15:31:32.032931 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:31:32.033331 [debug] [MainThread]: Command end result
[0m15:31:32.058940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:31:32.060170 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:31:32.063369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m15:31:32.063548 [info ] [MainThread]: 
[0m15:31:32.063988 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:31:32.064192 [info ] [MainThread]: 
[0m15:31:32.064391 [error] [MainThread]: [31mFailure in model dim_date (models/marts/dimensions/dim_date.sql)[0m
[0m15:31:32.064580 [error] [MainThread]:   Database Error in model dim_date (models/marts/dimensions/dim_date.sql)
  column "order_ts" does not exist
  LINE 16:         min(order_ts::date) as start_date,
                       ^
  HINT:  Perhaps you meant to reference the column "stg_orders_line.order_id".
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_date.sql
[0m15:31:32.064728 [info ] [MainThread]: 
[0m15:31:32.064898 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/marts/dimensions/dim_date.sql
[0m15:31:32.065038 [info ] [MainThread]: 
[0m15:31:32.065197 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:31:32.067229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.72116643, "process_in_blocks": "0", "process_kernel_time": 0.200131, "process_mem_max_rss": "128581632", "process_out_blocks": "0", "process_user_time": 1.162237}
[0m15:31:32.067494 [debug] [MainThread]: Command `dbt run` failed at 15:31:32.067451 after 0.72 seconds
[0m15:31:32.067689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa7570>]}
[0m15:31:32.067967 [debug] [MainThread]: Flushing usage events
[0m15:31:32.219094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:09.422217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfd7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfd79d0>]}


============================== 15:33:09.429566 | d8e9b33b-501f-4916-953c-f7098daea0ee ==============================
[0m15:33:09.429566 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:33:09.429902 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select dim_date', 'empty': 'False', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/bapbap23/.dbt', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:33:09.548940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acecd60>]}
[0m15:33:09.580194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8648d0>]}
[0m15:33:09.580754 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:33:09.635432 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:33:09.724426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:09.724942 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_date.sql
[0m15:33:09.992729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b2550>]}
[0m15:33:10.048481 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:33:10.050155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:33:10.066952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce49400>]}
[0m15:33:10.067235 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m15:33:10.067425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce7ce50>]}
[0m15:33:10.068670 [info ] [MainThread]: 
[0m15:33:10.068851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:10.069002 [info ] [MainThread]: 
[0m15:33:10.069246 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:10.069671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m15:33:10.114691 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m15:33:10.114938 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m15:33:10.115090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:10.163428 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.048 seconds
[0m15:33:10.164440 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m15:33:10.167721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m15:33:10.171504 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m15:33:10.171860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m15:33:10.172096 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:33:10.173180 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m15:33:10.173372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:10.173564 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m15:33:10.173839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:10.191160 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.017 seconds
[0m15:33:10.191481 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m15:33:10.192806 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m15:33:10.193725 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m15:33:10.194054 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m15:33:10.194250 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m15:33:10.197876 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:10.198151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:33:10.198382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:10.217589 [debug] [MainThread]: SQL status: SELECT 5 in 0.019 seconds
[0m15:33:10.218621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0e750>]}
[0m15:33:10.218936 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:10.219220 [debug] [MainThread]: On master: COMMIT
[0m15:33:10.219427 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:10.219605 [debug] [MainThread]: On master: COMMIT
[0m15:33:10.219922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:10.220120 [debug] [MainThread]: On master: Close
[0m15:33:10.221952 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.dim_date
[0m15:33:10.222329 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.dim_date ............................. [RUN]
[0m15:33:10.222632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.dim_date)
[0m15:33:10.222863 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.dim_date
[0m15:33:10.227940 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_date"
[0m15:33:10.228541 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.dim_date
[0m15:33:10.250615 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_date"
[0m15:33:10.251173 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m15:33:10.251397 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    select
        min(order_date::date) as start_date,
        max(order_date::date) as end_date
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
),

date_spine as (
    select generate_series(
        (select start_date from bounds),
        (select end_date from bounds),
        interval '1 day'
    )::date as date_day
)

select
    date_day,

    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon') as month_name,

    to_char(date_day, 'YYYY-MM') as year_month,

    extract(quarter from date_day)::int as quarter,
    extract(week from date_day)::int as week_of_year,

    extract(day from date_day)::int as day_of_month,
    to_char(date_day, 'Dy') as day_name,

    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
from date_spine
order by date_day
  );
  
[0m15:33:10.251600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:10.369989 [debug] [Thread-1 (]: SQL status: SELECT 2899 in 0.118 seconds
[0m15:33:10.375848 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m15:33:10.376043 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */
alter table "EnterpriseBI"."staging_mart"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:33:10.376869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:33:10.384596 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: COMMIT
[0m15:33:10.384831 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m15:33:10.385013 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: COMMIT
[0m15:33:10.386247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:33:10.389659 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."dim_date__dbt_backup"
[0m15:33:10.392233 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m15:33:10.392439 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */
drop table if exists "EnterpriseBI"."staging_mart"."dim_date__dbt_backup" cascade
[0m15:33:10.392807 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:33:10.394198 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_date: Close
[0m15:33:10.395287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8e9b33b-501f-4916-953c-f7098daea0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e170410>]}
[0m15:33:10.395651 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging_mart.dim_date ........................ [[32mSELECT 2899[0m in 0.17s]
[0m15:33:10.396013 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.dim_date
[0m15:33:10.396865 [debug] [MainThread]: On master: COMMIT
[0m15:33:10.397047 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:10.397200 [debug] [MainThread]: On master: COMMIT
[0m15:33:10.397346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:10.410292 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:33:10.410548 [debug] [MainThread]: On master: Close
[0m15:33:10.410785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:10.410928 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_date' was properly closed.
[0m15:33:10.411053 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_mart' was properly closed.
[0m15:33:10.411205 [info ] [MainThread]: 
[0m15:33:10.411364 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:33:10.411694 [debug] [MainThread]: Command end result
[0m15:33:10.439411 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m15:33:10.440751 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m15:33:10.444418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m15:33:10.444634 [info ] [MainThread]: 
[0m15:33:10.444869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:10.445044 [info ] [MainThread]: 
[0m15:33:10.445234 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:33:10.447252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0671287, "process_in_blocks": "0", "process_kernel_time": 0.226141, "process_mem_max_rss": "134332416", "process_out_blocks": "0", "process_user_time": 1.398474}
[0m15:33:10.447502 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:10.447455 after 1.07 seconds
[0m15:33:10.447702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc27ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce7930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce6710>]}
[0m15:33:10.447902 [debug] [MainThread]: Flushing usage events
[0m15:33:10.691021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:09:40.520383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c30590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acf9d0>]}


============================== 03:09:40.526121 | a4a5072d-81f4-4c39-8230-fe10b2ae34a0 ==============================
[0m03:09:40.526121 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:09:40.526472 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select dim_product', 'indirect_selection': 'eager', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/bapbap23/.dbt'}
[0m03:09:40.692776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a5072d-81f4-4c39-8230-fe10b2ae34a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de0d60>]}
[0m03:09:40.723951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a5072d-81f4-4c39-8230-fe10b2ae34a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5c8d0>]}
[0m03:09:40.724590 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:09:40.782201 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:09:40.874435 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m03:09:40.874967 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m03:09:40.875146 [debug] [MainThread]: Partial parsing: deleted file: enterprise_bi_project://models/marts/dimensions/dim_region.sql
[0m03:09:40.875364 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_product.sql
[0m03:09:40.875529 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m03:09:40.875731 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_customer.sql
[0m03:09:41.046597 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_region' in the 'models' section of file 'models/marts/marts.yml'
[0m03:09:41.119686 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enterprise_bi_project.dim_store' (models/marts/dimensions/dim_store.sql) depends on a node named 'dim_region' which was not found
[0m03:09:41.124087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.64685947, "process_in_blocks": "0", "process_kernel_time": 0.22045, "process_mem_max_rss": "120061952", "process_out_blocks": "0", "process_user_time": 1.170492}
[0m03:09:41.124342 [debug] [MainThread]: Command `dbt run` failed at 03:09:41.124288 after 0.65 seconds
[0m03:09:41.124550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b61d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a63d40>]}
[0m03:09:41.124735 [debug] [MainThread]: Flushing usage events
[0m03:09:41.321090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:12:14.532371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766f9d0>]}


============================== 03:12:14.540132 | 0450c1bb-3321-448e-9abc-5bc599c54b68 ==============================
[0m03:12:14.540132 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:12:14.540475 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/Users/bapbap23/.dbt', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m03:12:14.658807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106980d60>]}
[0m03:12:14.703328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fc8d0>]}
[0m03:12:14.705069 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:12:14.789648 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:12:14.921892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m03:12:14.922538 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m03:12:14.922732 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_region.sql
[0m03:12:14.922960 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_customer.sql
[0m03:12:14.923130 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_store.sql
[0m03:12:14.923343 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_product.sql
[0m03:12:15.303968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b5950>]}
[0m03:12:15.357958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m03:12:15.359357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m03:12:15.377468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ed400>]}
[0m03:12:15.377747 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m03:12:15.377932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092126d0>]}
[0m03:12:15.379571 [info ] [MainThread]: 
[0m03:12:15.379759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:12:15.379904 [info ] [MainThread]: 
[0m03:12:15.380151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:12:15.382354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m03:12:15.382628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m03:12:15.435674 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m03:12:15.435923 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m03:12:15.436221 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m03:12:15.436438 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m03:12:15.436624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:15.436789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:15.523891 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.087 seconds
[0m03:12:15.524255 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.087 seconds
[0m03:12:15.525351 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m03:12:15.526200 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m03:12:15.527879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m03:12:15.528254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m03:12:15.532209 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m03:12:15.533408 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m03:12:15.533648 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m03:12:15.533887 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m03:12:15.534087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:15.534260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:15.554661 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m03:12:15.554995 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.021 seconds
[0m03:12:15.556028 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m03:12:15.556812 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m03:12:15.557115 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m03:12:15.557309 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m03:12:15.561704 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:15.562029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:12:15.562283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:15.583162 [debug] [MainThread]: SQL status: SELECT 5 in 0.021 seconds
[0m03:12:15.584158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109314600>]}
[0m03:12:15.584476 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:15.584786 [debug] [MainThread]: On master: COMMIT
[0m03:12:15.584966 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:15.585138 [debug] [MainThread]: On master: COMMIT
[0m03:12:15.585684 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:12:15.585856 [debug] [MainThread]: On master: Close
[0m03:12:15.587731 [debug] [Thread-3 (]: Began running node model.enterprise_bi_project.stg_products
[0m03:12:15.587989 [debug] [Thread-4 (]: Began running node model.enterprise_bi_project.stg_regions
[0m03:12:15.588245 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.stg_customers
[0m03:12:15.588459 [debug] [Thread-2 (]: Began running node model.enterprise_bi_project.stg_orders_line
[0m03:12:15.588770 [info ] [Thread-3 (]: 3 of 11 START sql view model staging_staging.stg_products ...................... [RUN]
[0m03:12:15.589101 [info ] [Thread-4 (]: 4 of 11 START sql view model staging_staging.stg_regions ....................... [RUN]
[0m03:12:15.589418 [info ] [Thread-1 (]: 1 of 11 START sql view model staging_staging.stg_customers ..................... [RUN]
[0m03:12:15.589721 [info ] [Thread-2 (]: 2 of 11 START sql view model staging_staging.stg_orders_line ................... [RUN]
[0m03:12:15.590050 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.enterprise_bi_project.stg_products'
[0m03:12:15.590352 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.enterprise_bi_project.stg_regions'
[0m03:12:15.590587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.stg_customers)
[0m03:12:15.590817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.stg_orders_line)
[0m03:12:15.591039 [debug] [Thread-3 (]: Began compiling node model.enterprise_bi_project.stg_products
[0m03:12:15.591263 [debug] [Thread-4 (]: Began compiling node model.enterprise_bi_project.stg_regions
[0m03:12:15.591477 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.stg_customers
[0m03:12:15.591680 [debug] [Thread-2 (]: Began compiling node model.enterprise_bi_project.stg_orders_line
[0m03:12:15.596733 [debug] [Thread-3 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_products"
[0m03:12:15.598789 [debug] [Thread-4 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_regions"
[0m03:12:15.600343 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_customers"
[0m03:12:15.602114 [debug] [Thread-2 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.606378 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.stg_customers
[0m03:12:15.606633 [debug] [Thread-4 (]: Began executing node model.enterprise_bi_project.stg_regions
[0m03:12:15.608535 [debug] [Thread-2 (]: Began executing node model.enterprise_bi_project.stg_orders_line
[0m03:12:15.615897 [debug] [Thread-3 (]: Began executing node model.enterprise_bi_project.stg_products
[0m03:12:15.629568 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_customers"
[0m03:12:15.631572 [debug] [Thread-4 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_regions"
[0m03:12:15.633121 [debug] [Thread-2 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.634793 [debug] [Thread-3 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_products"
[0m03:12:15.635628 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m03:12:15.635856 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m03:12:15.636047 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.636246 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m03:12:15.636443 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */

  create view "EnterpriseBI"."staging_staging"."stg_regions__dbt_tmp"
    
    
  as (
    select 
    region_name::text as region_name,
    active_flag::text as active_flag,
    region_code::text as region_code
from "EnterpriseBI"."raw"."regions"
where region_name is not null
  );
[0m03:12:15.636645 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */

  create view "EnterpriseBI"."staging_staging"."stg_customers__dbt_tmp"
    
    
  as (
    select 
    customer_code::text as customer_code,
    signup_date::date as signup_date,
    customer_segment::text as customer_segment,
    email::text as email,
    loyalty_id::text as loyalty_id
from "EnterpriseBI"."raw"."customers"
where customer_code is not null
  );
[0m03:12:15.636857 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */

  create view "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_tmp"
    
    
  as (
    

select
  order_code::text        as order_id,
  line_number::int        as line_number,

  store_code::text        as store_id,
  customer_code::text     as customer_id,
  product_code::text      as product_id,

  order_ts::date          as order_date,
  delivery_ts::date       as delivery_date,

  order_type::text        as order_type,
  order_status::text      as order_status,

  quantity::int           as quantity,
  unit_price::numeric     as unit_price,
  unit_cost::numeric      as unit_cost,

  (quantity::numeric * unit_price::numeric) as line_revenue,
  (quantity::numeric * unit_cost::numeric)  as line_cost,
  (quantity::numeric * (unit_price::numeric - unit_cost::numeric)) as line_margin

from "EnterpriseBI"."raw"."orders"
where order_code is not null
  and line_number is not null
  );
[0m03:12:15.637065 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */

  create view "EnterpriseBI"."staging_staging"."stg_products__dbt_tmp"
    
    
  as (
    select 
    product_code::text as product_code,
    product_name::text as product_name,
    category::text as category,
    base_price::float as base_price,
    active_flag::text as active_flag
from "EnterpriseBI"."raw"."products"
where product_code is not null
  );
[0m03:12:15.637246 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:12:15.637411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:15.637569 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:12:15.637724 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:12:15.662028 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m03:12:15.662361 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m03:12:15.662607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m03:12:15.666788 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m03:12:15.667035 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m03:12:15.668969 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.670591 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m03:12:15.670820 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */
alter table "EnterpriseBI"."staging_staging"."stg_products" rename to "stg_products__dbt_backup"
[0m03:12:15.672477 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m03:12:15.672691 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */
alter table "EnterpriseBI"."staging_staging"."stg_orders_line" rename to "stg_orders_line__dbt_backup"
[0m03:12:15.672892 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */
alter table "EnterpriseBI"."staging_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m03:12:15.673143 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */
alter table "EnterpriseBI"."staging_staging"."stg_regions" rename to "stg_regions__dbt_backup"
[0m03:12:15.673602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:15.675200 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.675443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:12:15.675667 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:12:15.675868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m03:12:15.676070 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */
alter table "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_tmp" rename to "stg_orders_line"
[0m03:12:15.677624 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m03:12:15.679268 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m03:12:15.680731 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m03:12:15.680967 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */
alter table "EnterpriseBI"."staging_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m03:12:15.681163 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */
alter table "EnterpriseBI"."staging_staging"."stg_regions__dbt_tmp" rename to "stg_regions"
[0m03:12:15.681360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:15.681552 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */
alter table "EnterpriseBI"."staging_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:12:15.688108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m03:12:15.688317 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m03:12:15.691028 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: COMMIT
[0m03:12:15.691864 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: COMMIT
[0m03:12:15.692102 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m03:12:15.692885 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: COMMIT
[0m03:12:15.693079 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.693256 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m03:12:15.693989 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: COMMIT
[0m03:12:15.694171 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m03:12:15.694339 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: COMMIT
[0m03:12:15.694500 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: COMMIT
[0m03:12:15.694661 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m03:12:15.694818 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: COMMIT
[0m03:12:15.695016 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: COMMIT
[0m03:12:15.695838 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:15.696026 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:15.699531 [debug] [Thread-2 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_backup"
[0m03:12:15.699734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m03:12:15.699918 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m03:12:15.700992 [debug] [Thread-4 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_regions__dbt_backup"
[0m03:12:15.703445 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.stg_orders_line"
[0m03:12:15.704659 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_customers__dbt_backup"
[0m03:12:15.705670 [debug] [Thread-3 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_products__dbt_backup"
[0m03:12:15.706019 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.stg_regions"
[0m03:12:15.706200 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_orders_line"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_orders_line__dbt_backup" cascade
[0m03:12:15.706537 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.stg_customers"
[0m03:12:15.706873 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_products"
[0m03:12:15.707042 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_regions"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_regions__dbt_backup" cascade
[0m03:12:15.707245 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_customers"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_customers__dbt_backup" cascade
[0m03:12:15.707418 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_products"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_products__dbt_backup" cascade
[0m03:12:15.709651 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m03:12:15.710978 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_products: Close
[0m03:12:15.711181 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m03:12:15.711358 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m03:12:15.712169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m03:12:15.712846 [debug] [Thread-4 (]: On model.enterprise_bi_project.stg_regions: Close
[0m03:12:15.713530 [debug] [Thread-2 (]: On model.enterprise_bi_project.stg_orders_line: Close
[0m03:12:15.714187 [debug] [Thread-1 (]: On model.enterprise_bi_project.stg_customers: Close
[0m03:12:15.714782 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109337b90>]}
[0m03:12:15.715333 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933dc80>]}
[0m03:12:15.715183 [info ] [Thread-3 (]: 3 of 11 OK created sql view model staging_staging.stg_products ................. [[32mCREATE VIEW[0m in 0.12s]
[0m03:12:15.715552 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109782670>]}
[0m03:12:15.715731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c5d00>]}
[0m03:12:15.716208 [debug] [Thread-3 (]: Finished running node model.enterprise_bi_project.stg_products
[0m03:12:15.715973 [info ] [Thread-4 (]: 4 of 11 OK created sql view model staging_staging.stg_regions .................. [[32mCREATE VIEW[0m in 0.12s]
[0m03:12:15.716539 [info ] [Thread-2 (]: 2 of 11 OK created sql view model staging_staging.stg_orders_line .............. [[32mCREATE VIEW[0m in 0.12s]
[0m03:12:15.717010 [debug] [Thread-3 (]: Began running node model.enterprise_bi_project.stg_stores
[0m03:12:15.716832 [info ] [Thread-1 (]: 1 of 11 OK created sql view model staging_staging.stg_customers ................ [[32mCREATE VIEW[0m in 0.12s]
[0m03:12:15.717363 [debug] [Thread-4 (]: Finished running node model.enterprise_bi_project.stg_regions
[0m03:12:15.717635 [debug] [Thread-2 (]: Finished running node model.enterprise_bi_project.stg_orders_line
[0m03:12:15.718075 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.stg_customers
[0m03:12:15.717851 [info ] [Thread-3 (]: 5 of 11 START sql view model staging_staging.stg_stores ........................ [RUN]
[0m03:12:15.718314 [debug] [Thread-4 (]: Began running node model.enterprise_bi_project.dim_product
[0m03:12:15.718559 [debug] [Thread-2 (]: Began running node model.enterprise_bi_project.dim_region
[0m03:12:15.718830 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.stg_products, now model.enterprise_bi_project.stg_stores)
[0m03:12:15.719023 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.dim_customer
[0m03:12:15.719241 [info ] [Thread-4 (]: 6 of 11 START sql table model staging_mart.dim_product ......................... [RUN]
[0m03:12:15.719630 [debug] [Thread-3 (]: Began compiling node model.enterprise_bi_project.stg_stores
[0m03:12:15.719442 [info ] [Thread-2 (]: 7 of 11 START sql table model staging_mart.dim_region .......................... [RUN]
[0m03:12:15.719895 [info ] [Thread-1 (]: 8 of 11 START sql table model staging_mart.dim_customer ........................ [RUN]
[0m03:12:15.720102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.stg_regions, now model.enterprise_bi_project.dim_product)
[0m03:12:15.721748 [debug] [Thread-3 (]: Writing injected SQL for node "model.enterprise_bi_project.stg_stores"
[0m03:12:15.722015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.stg_orders_line, now model.enterprise_bi_project.dim_region)
[0m03:12:15.722228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.stg_customers, now model.enterprise_bi_project.dim_customer)
[0m03:12:15.722423 [debug] [Thread-4 (]: Began compiling node model.enterprise_bi_project.dim_product
[0m03:12:15.722638 [debug] [Thread-2 (]: Began compiling node model.enterprise_bi_project.dim_region
[0m03:12:15.722842 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.dim_customer
[0m03:12:15.724633 [debug] [Thread-4 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_product"
[0m03:12:15.726042 [debug] [Thread-2 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_region"
[0m03:12:15.727571 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_customer"
[0m03:12:15.727910 [debug] [Thread-3 (]: Began executing node model.enterprise_bi_project.stg_stores
[0m03:12:15.730016 [debug] [Thread-3 (]: Writing runtime sql for node "model.enterprise_bi_project.stg_stores"
[0m03:12:15.730294 [debug] [Thread-4 (]: Began executing node model.enterprise_bi_project.dim_product
[0m03:12:15.730517 [debug] [Thread-2 (]: Began executing node model.enterprise_bi_project.dim_region
[0m03:12:15.742894 [debug] [Thread-4 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_product"
[0m03:12:15.744658 [debug] [Thread-2 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_region"
[0m03:12:15.744921 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.dim_customer
[0m03:12:15.746664 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_customer"
[0m03:12:15.746949 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m03:12:15.747181 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */

  create view "EnterpriseBI"."staging_staging"."stg_stores__dbt_tmp"
    
    
  as (
    select 
    store_code::text as store_code,
    store_name::text as store_name,
    city::text as city,
    state::text as state,
    region_name::text as region_name,
    open_date::date as open_date,
    close_date::date as close_date,
    square_feet::float as square_feet
from "EnterpriseBI"."raw"."stores"
where store_code is not null
  );
[0m03:12:15.747378 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:12:15.747583 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_region"
[0m03:12:15.747879 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.dim_product"
[0m03:12:15.748073 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_region: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_region"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_region__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        region_name
    from "EnterpriseBI"."staging_staging"."stg_regions"
    where region_name is not null
    group by region_name
)

select
    row_number() over (order by region_name) as region_key,
    region_name::text                         as region_name
from base
  );
  
[0m03:12:15.748298 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_customer"
[0m03:12:15.748506 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_product"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_product__dbt_tmp"
  
  
    as
  
  (
    

select 
    product_code::text as product_code,
    product_name::text as product_name,
    category::text as category,
    base_price::float as base_price,
    active_flag::text as active_flag
from "EnterpriseBI"."staging_staging"."stg_products"
where product_code is not null and is_unique(product_code)
  );
  
[0m03:12:15.748711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:12:15.748908 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_customer"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select 
    customer_code::text as customer_code,
    signup_date::date as signup_date,
    customer_segment::text as customer_segment,
    email::text as email,
    loyalty_id::text as loyalty_id
from "EnterpriseBI"."staging_staging"."stg_customers"
where customer_code is not null and is_unique(customer_code)
  );
  
[0m03:12:15.749100 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:12:15.749321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:15.764731 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m03:12:15.766774 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m03:12:15.767059 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function is_unique(text) does not exist
LINE 21: where customer_code is not null and is_unique(customer_code)
                                             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m03:12:15.767311 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */
alter table "EnterpriseBI"."staging_staging"."stg_stores" rename to "stg_stores__dbt_backup"
[0m03:12:15.767543 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function is_unique(text) does not exist
LINE 21: where product_code is not null and is_unique(product_code)
                                            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m03:12:15.767767 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.019 seconds
[0m03:12:15.767972 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: ROLLBACK
[0m03:12:15.768200 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_product: ROLLBACK
[0m03:12:15.774097 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m03:12:15.774934 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_region"
[0m03:12:15.776810 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m03:12:15.777461 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: Close
[0m03:12:15.777804 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_product: Close
[0m03:12:15.778057 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_region: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_region"} */
alter table "EnterpriseBI"."staging_mart"."dim_region__dbt_tmp" rename to "dim_region"
[0m03:12:15.778303 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */
alter table "EnterpriseBI"."staging_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m03:12:15.779917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:15.780147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:15.781047 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: COMMIT
[0m03:12:15.781804 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_region: COMMIT
[0m03:12:15.782046 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m03:12:15.782291 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_region"
[0m03:12:15.782570 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: COMMIT
[0m03:12:15.782759 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_region: COMMIT
[0m03:12:15.783289 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m03:12:15.783529 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:15.785008 [debug] [Thread-3 (]: Applying DROP to: "EnterpriseBI"."staging_staging"."stg_stores__dbt_backup"
[0m03:12:15.786187 [debug] [Thread-2 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."dim_region__dbt_backup"
[0m03:12:15.786581 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.stg_stores"
[0m03:12:15.788165 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_region"
[0m03:12:15.788454 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.stg_stores"} */
drop view if exists "EnterpriseBI"."staging_staging"."stg_stores__dbt_backup" cascade
[0m03:12:15.788655 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_region: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_region"} */
drop table if exists "EnterpriseBI"."staging_mart"."dim_region__dbt_backup" cascade
[0m03:12:15.789030 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:12:15.789814 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_region: Close
[0m03:12:15.790017 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m03:12:15.790337 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d931400>]}
[0m03:12:15.791123 [debug] [Thread-3 (]: On model.enterprise_bi_project.stg_stores: Close
[0m03:12:15.791595 [info ] [Thread-2 (]: 7 of 11 OK created sql table model staging_mart.dim_region ..................... [[32mSELECT 4[0m in 0.07s]
[0m03:12:15.792188 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8055b0>]}
[0m03:12:15.792476 [debug] [Thread-2 (]: Finished running node model.enterprise_bi_project.dim_region
[0m03:12:15.792865 [info ] [Thread-3 (]: 5 of 11 OK created sql view model staging_staging.stg_stores ................... [[32mCREATE VIEW[0m in 0.07s]
[0m03:12:15.793174 [debug] [Thread-2 (]: Began running node model.enterprise_bi_project.dim_date
[0m03:12:15.793608 [debug] [Thread-3 (]: Finished running node model.enterprise_bi_project.stg_stores
[0m03:12:15.794097 [debug] [Thread-3 (]: Began running node model.enterprise_bi_project.fact_orders
[0m03:12:15.793859 [info ] [Thread-2 (]: 9 of 11 START sql table model staging_mart.dim_date ............................ [RUN]
[0m03:12:15.794488 [info ] [Thread-3 (]: 10 of 11 START sql table model staging_mart.fact_orders ........................ [RUN]
[0m03:12:15.794787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.dim_region, now model.enterprise_bi_project.dim_date)
[0m03:12:15.795050 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.stg_stores, now model.enterprise_bi_project.fact_orders)
[0m03:12:15.795313 [debug] [Thread-2 (]: Began compiling node model.enterprise_bi_project.dim_date
[0m03:12:15.795563 [debug] [Thread-3 (]: Began compiling node model.enterprise_bi_project.fact_orders
[0m03:12:15.797221 [debug] [Thread-2 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_date"
[0m03:12:15.799518 [debug] [Thread-3 (]: Writing injected SQL for node "model.enterprise_bi_project.fact_orders"
[0m03:12:15.800347 [debug] [Thread-2 (]: Began executing node model.enterprise_bi_project.dim_date
[0m03:12:15.802461 [debug] [Thread-2 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_date"
[0m03:12:15.803129 [debug] [Thread-3 (]: Began executing node model.enterprise_bi_project.fact_orders
[0m03:12:15.805140 [debug] [Thread-3 (]: Writing runtime sql for node "model.enterprise_bi_project.fact_orders"
[0m03:12:15.808142 [debug] [Thread-4 (]: Database Error in model dim_product (models/marts/dimensions/dim_product.sql)
  function is_unique(text) does not exist
  LINE 21: where product_code is not null and is_unique(product_code)
                                              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_product.sql
[0m03:12:15.808454 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932bdd0>]}
[0m03:12:15.808695 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m03:12:15.809196 [debug] [Thread-1 (]: Database Error in model dim_customer (models/marts/dimensions/dim_customer.sql)
  function is_unique(text) does not exist
  LINE 21: where customer_code is not null and is_unique(customer_code)
                                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_customer.sql
[0m03:12:15.809528 [error] [Thread-4 (]: 6 of 11 ERROR creating sql table model staging_mart.dim_product ................ [[31mERROR[0m in 0.09s]
[0m03:12:15.809902 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with bounds as (
    select
        min(order_date::date) as start_date,
        max(order_date::date) as end_date
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
),

date_spine as (
    select generate_series(
        (select start_date from bounds),
        (select end_date from bounds),
        interval '1 day'
    )::date as date_day
)

select
    date_day,

    extract(year from date_day)::int as year,
    extract(month from date_day)::int as month,
    to_char(date_day, 'Mon') as month_name,

    to_char(date_day, 'YYYY-MM') as year_month,

    extract(quarter from date_day)::int as quarter,
    extract(week from date_day)::int as week_of_year,

    extract(day from date_day)::int as day_of_month,
    to_char(date_day, 'Dy') as day_name,

    case when extract(isodow from date_day) in (6,7) then true else false end as is_weekend
from date_spine
order by date_day
  );
  
[0m03:12:15.810150 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m03:12:15.810418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f8bf0>]}
[0m03:12:15.810770 [debug] [Thread-4 (]: Finished running node model.enterprise_bi_project.dim_product
[0m03:12:15.810972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:12:15.811205 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

with lines as (
    select
        order_id      as order_code,
        customer_id   as customer_code,
        store_id      as store_code,

        order_date    as order_ts,
        delivery_date as delivery_ts,
        order_status,
        order_type,

        quantity,
        unit_price,
        unit_cost
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
)

select
    order_code,

    -- dimensions / keys for slicing
    customer_code,
    store_code,

    -- timestamps (choose a rule; min/max is safe)
    min(order_ts)    as order_ts,
    max(delivery_ts) as delivery_ts,

    -- order-level metrics (sum across lines)
    sum(quantity * unit_price)                        as order_revenue,
    sum(quantity * unit_cost)                         as order_cost,
    sum(quantity * (unit_price - unit_cost))          as order_margin,
    count(*)                                          as line_count,
    sum(quantity)                                     as total_units,

    -- status/type: if consistent per order, max() is fine
    max(order_status) as order_status,
    max(order_type)   as order_type

from lines
group by 1,2,3
  );
  
[0m03:12:15.811763 [debug] [Thread-4 (]: Began running node model.enterprise_bi_project.dim_store
[0m03:12:15.811581 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model staging_mart.dim_customer ............... [[31mERROR[0m in 0.09s]
[0m03:12:15.812553 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/marts/dimensions/dim_product.sql)
  function is_unique(text) does not exist
  LINE 21: where product_code is not null and is_unique(product_code)
                                              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_product.sql.
[0m03:12:15.812912 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:12:15.813197 [info ] [Thread-4 (]: 11 of 11 START sql table model staging_mart.dim_store .......................... [RUN]
[0m03:12:15.813523 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.dim_customer
[0m03:12:15.814214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.enterprise_bi_project.dim_product, now model.enterprise_bi_project.dim_store)
[0m03:12:15.814501 [debug] [Thread-7 (]: Marking all children of 'model.enterprise_bi_project.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/marts/dimensions/dim_customer.sql)
  function is_unique(text) does not exist
  LINE 21: where customer_code is not null and is_unique(customer_code)
                                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_customer.sql.
[0m03:12:15.814722 [debug] [Thread-4 (]: Began compiling node model.enterprise_bi_project.dim_store
[0m03:12:15.817895 [debug] [Thread-4 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_store"
[0m03:12:15.818530 [debug] [Thread-4 (]: Began executing node model.enterprise_bi_project.dim_store
[0m03:12:15.820909 [debug] [Thread-4 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_store"
[0m03:12:15.821520 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.dim_store"
[0m03:12:15.821798 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_store: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_store"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_store__dbt_tmp"
  
  
    as
  
  (
    

select
    "EnterpriseBI"."staging_staging"."stg_stores".store_code::text as store_code,
    "EnterpriseBI"."staging_staging"."stg_stores".store_name::text as store_name,
    "EnterpriseBI"."staging_staging"."stg_stores".city::text as city,
    "EnterpriseBI"."staging_staging"."stg_stores".state::text as state,
    "EnterpriseBI"."staging_mart"."dim_region".region_name::text as region_name,
    "EnterpriseBI"."staging_staging"."stg_stores".open_date::date as open_date,
    "EnterpriseBI"."staging_staging"."stg_stores".close_date::date as close_date,
    "EnterpriseBI"."staging_staging"."stg_stores".square_feet::float as square_feet
from "EnterpriseBI"."staging_staging"."stg_stores"
join "EnterpriseBI"."staging_mart"."dim_region" on "EnterpriseBI"."staging_staging"."stg_stores".region_name = "EnterpriseBI"."staging_mart"."dim_region".region_name
  );
  
[0m03:12:15.822041 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:12:15.852493 [debug] [Thread-4 (]: SQL status: SELECT 1949 in 0.030 seconds
[0m03:12:15.854945 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.dim_store"
[0m03:12:15.855216 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_store: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_store"} */
alter table "EnterpriseBI"."staging_mart"."dim_store__dbt_tmp" rename to "dim_store"
[0m03:12:15.856932 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:12:15.858085 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_store: COMMIT
[0m03:12:15.858333 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.dim_store"
[0m03:12:15.858538 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_store: COMMIT
[0m03:12:15.859076 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m03:12:15.860454 [debug] [Thread-4 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."dim_store__dbt_backup"
[0m03:12:15.860879 [debug] [Thread-4 (]: Using postgres connection "model.enterprise_bi_project.dim_store"
[0m03:12:15.861088 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_store: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_store"} */
drop table if exists "EnterpriseBI"."staging_mart"."dim_store__dbt_backup" cascade
[0m03:12:15.861457 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:12:15.862253 [debug] [Thread-4 (]: On model.enterprise_bi_project.dim_store: Close
[0m03:12:15.862589 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d806990>]}
[0m03:12:15.863246 [info ] [Thread-4 (]: 11 of 11 OK created sql table model staging_mart.dim_store ..................... [[32mSELECT 1949[0m in 0.05s]
[0m03:12:15.863955 [debug] [Thread-4 (]: Finished running node model.enterprise_bi_project.dim_store
[0m03:12:16.209167 [debug] [Thread-2 (]: SQL status: SELECT 2899 in 0.398 seconds
[0m03:12:16.215229 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m03:12:16.215852 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */
alter table "EnterpriseBI"."staging_mart"."dim_date" rename to "dim_date__dbt_backup"
[0m03:12:16.216517 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:16.218178 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m03:12:16.218374 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */
alter table "EnterpriseBI"."staging_mart"."dim_date__dbt_tmp" rename to "dim_date"
[0m03:12:16.218823 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:16.219655 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: COMMIT
[0m03:12:16.219843 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m03:12:16.220009 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: COMMIT
[0m03:12:16.220802 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m03:12:16.222292 [debug] [Thread-2 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."dim_date__dbt_backup"
[0m03:12:16.222681 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_date"
[0m03:12:16.222865 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_date"} */
drop table if exists "EnterpriseBI"."staging_mart"."dim_date__dbt_backup" cascade
[0m03:12:16.228654 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m03:12:16.229568 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_date: Close
[0m03:12:16.229941 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932b350>]}
[0m03:12:16.230361 [info ] [Thread-2 (]: 9 of 11 OK created sql table model staging_mart.dim_date ....................... [[32mSELECT 2899[0m in 0.44s]
[0m03:12:16.230769 [debug] [Thread-2 (]: Finished running node model.enterprise_bi_project.dim_date
[0m03:12:17.330810 [debug] [Thread-3 (]: SQL status: SELECT 193079 in 1.517 seconds
[0m03:12:17.339270 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m03:12:17.340184 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
alter table "EnterpriseBI"."staging_mart"."fact_orders" rename to "fact_orders__dbt_backup"
[0m03:12:17.341218 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:17.342829 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m03:12:17.343021 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
alter table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m03:12:17.343393 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:12:17.344207 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: COMMIT
[0m03:12:17.344389 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m03:12:17.344555 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: COMMIT
[0m03:12:17.347089 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m03:12:17.348674 [debug] [Thread-3 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."fact_orders__dbt_backup"
[0m03:12:17.349057 [debug] [Thread-3 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m03:12:17.349242 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
drop table if exists "EnterpriseBI"."staging_mart"."fact_orders__dbt_backup" cascade
[0m03:12:17.351505 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m03:12:17.352231 [debug] [Thread-3 (]: On model.enterprise_bi_project.fact_orders: Close
[0m03:12:17.352587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0450c1bb-3321-448e-9abc-5bc599c54b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932b9b0>]}
[0m03:12:17.353031 [info ] [Thread-3 (]: 10 of 11 OK created sql table model staging_mart.fact_orders ................... [[32mSELECT 193079[0m in 1.56s]
[0m03:12:17.353473 [debug] [Thread-3 (]: Finished running node model.enterprise_bi_project.fact_orders
[0m03:12:17.354432 [debug] [MainThread]: On master: COMMIT
[0m03:12:17.354639 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:17.354795 [debug] [MainThread]: On master: COMMIT
[0m03:12:17.354937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:17.367877 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m03:12:17.369477 [debug] [MainThread]: On master: Close
[0m03:12:17.369735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:17.369888 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_customer' was properly closed.
[0m03:12:17.370054 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_date' was properly closed.
[0m03:12:17.370216 [debug] [MainThread]: Connection 'model.enterprise_bi_project.fact_orders' was properly closed.
[0m03:12:17.370352 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_store' was properly closed.
[0m03:12:17.370597 [info ] [MainThread]: 
[0m03:12:17.370776 [info ] [MainThread]: Finished running 6 table models, 5 view models in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m03:12:17.371728 [debug] [MainThread]: Command end result
[0m03:12:17.410449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m03:12:17.412346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m03:12:17.417393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m03:12:17.417637 [info ] [MainThread]: 
[0m03:12:17.417931 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:12:17.418178 [info ] [MainThread]: 
[0m03:12:17.418473 [error] [MainThread]: [31mFailure in model dim_product (models/marts/dimensions/dim_product.sql)[0m
[0m03:12:17.418761 [error] [MainThread]:   Database Error in model dim_product (models/marts/dimensions/dim_product.sql)
  function is_unique(text) does not exist
  LINE 21: where product_code is not null and is_unique(product_code)
                                              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_product.sql
[0m03:12:17.418983 [info ] [MainThread]: 
[0m03:12:17.419235 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/marts/dimensions/dim_product.sql
[0m03:12:17.419454 [info ] [MainThread]: 
[0m03:12:17.419706 [error] [MainThread]: [31mFailure in model dim_customer (models/marts/dimensions/dim_customer.sql)[0m
[0m03:12:17.419946 [error] [MainThread]:   Database Error in model dim_customer (models/marts/dimensions/dim_customer.sql)
  function is_unique(text) does not exist
  LINE 21: where customer_code is not null and is_unique(customer_code)
                                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/enterprise_bi_project/models/marts/dimensions/dim_customer.sql
[0m03:12:17.420128 [info ] [MainThread]: 
[0m03:12:17.420330 [info ] [MainThread]:   compiled code at target/compiled/enterprise_bi_project/models/marts/dimensions/dim_customer.sql
[0m03:12:17.420505 [info ] [MainThread]: 
[0m03:12:17.420703 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=11
[0m03:12:17.423546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9331698, "process_in_blocks": "0", "process_kernel_time": 0.287775, "process_mem_max_rss": "130875392", "process_out_blocks": "0", "process_user_time": 1.664652}
[0m03:12:17.423969 [debug] [MainThread]: Command `dbt run` failed at 03:12:17.423894 after 2.93 seconds
[0m03:12:17.424418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106946450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d894170>]}
[0m03:12:17.424676 [debug] [MainThread]: Flushing usage events
[0m03:12:17.642615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:42.362962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105173890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051739d0>]}


============================== 03:13:42.376044 | ff2791e1-fbf0-43cc-b349-e410eb9b7890 ==============================
[0m03:13:42.376044 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:13:42.376405 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'empty': 'False', 'write_json': 'True', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'invocation_command': 'dbt run --select dim_customer dim_product', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/Users/bapbap23/.dbt', 'use_colors': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m03:13:42.494676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104488d60>]}
[0m03:13:42.526158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052008d0>]}
[0m03:13:42.526726 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:13:42.628571 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:13:42.714473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:13:42.714957 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_product.sql
[0m03:13:42.715184 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/dimensions/dim_customer.sql
[0m03:13:42.973873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106272e50>]}
[0m03:13:43.027795 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m03:13:43.029181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m03:13:43.045695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f31400>]}
[0m03:13:43.045979 [info ] [MainThread]: Found 11 models, 71 data tests, 5 sources, 464 macros
[0m03:13:43.046166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105149010>]}
[0m03:13:43.047646 [info ] [MainThread]: 
[0m03:13:43.047826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:13:43.047974 [info ] [MainThread]: 
[0m03:13:43.048218 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:13:43.050111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m03:13:43.096861 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m03:13:43.097108 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m03:13:43.097261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:43.147453 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.050 seconds
[0m03:13:43.148449 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m03:13:43.149700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m03:13:43.153534 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m03:13:43.153852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m03:13:43.154098 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m03:13:43.155256 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m03:13:43.155463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:43.155691 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m03:13:43.155988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:43.177485 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m03:13:43.177829 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m03:13:43.178910 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m03:13:43.180340 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m03:13:43.180759 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m03:13:43.180966 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m03:13:43.184971 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:43.185270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:13:43.185522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:43.206987 [debug] [MainThread]: SQL status: SELECT 5 in 0.021 seconds
[0m03:13:43.208078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d6270>]}
[0m03:13:43.208420 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:43.208784 [debug] [MainThread]: On master: COMMIT
[0m03:13:43.208996 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:43.209190 [debug] [MainThread]: On master: COMMIT
[0m03:13:43.209609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:13:43.209789 [debug] [MainThread]: On master: Close
[0m03:13:43.211598 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.dim_customer
[0m03:13:43.211874 [debug] [Thread-2 (]: Began running node model.enterprise_bi_project.dim_product
[0m03:13:43.212248 [info ] [Thread-1 (]: 1 of 2 START sql table model staging_mart.dim_customer ......................... [RUN]
[0m03:13:43.212620 [info ] [Thread-2 (]: 2 of 2 START sql table model staging_mart.dim_product .......................... [RUN]
[0m03:13:43.212924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.dim_customer)
[0m03:13:43.213192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.dim_product)
[0m03:13:43.213440 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.dim_customer
[0m03:13:43.213668 [debug] [Thread-2 (]: Began compiling node model.enterprise_bi_project.dim_product
[0m03:13:43.219094 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_customer"
[0m03:13:43.220734 [debug] [Thread-2 (]: Writing injected SQL for node "model.enterprise_bi_project.dim_product"
[0m03:13:43.221340 [debug] [Thread-2 (]: Began executing node model.enterprise_bi_project.dim_product
[0m03:13:43.221574 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.dim_customer
[0m03:13:43.247241 [debug] [Thread-2 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_product"
[0m03:13:43.247760 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.dim_customer"
[0m03:13:43.248541 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_product"
[0m03:13:43.248760 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_customer"
[0m03:13:43.248978 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_product"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_product__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select 
        product_code::text as product_code,
        product_name::text as product_name,
        category::text as category,
        base_price::float as base_price,
        active_flag::text as active_flag,
        row_number() over (partition by product_code order by product_code) as rn
    from "EnterpriseBI"."staging_staging"."stg_products"
    where product_code is not null
)

select
    product_code,
    product_name,
    category,
    base_price,
    active_flag
from base
where rn = 1
  );
  
[0m03:13:43.249196 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_customer"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select 
        customer_code::text as customer_code,
        signup_date::date as signup_date,
        customer_segment::text as customer_segment,
        email::text as email,
        loyalty_id::text as loyalty_id,
        row_number() over (partition by customer_code order by customer_code) as rn
    from "EnterpriseBI"."staging_staging"."stg_customers"
    where customer_code is not null
)

select
    customer_code,
    signup_date,
    customer_segment,
    email,
    loyalty_id
from base
where rn = 1
  );
  
[0m03:13:43.249382 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:13:43.249544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:43.277010 [debug] [Thread-2 (]: SQL status: SELECT 2441 in 0.028 seconds
[0m03:13:43.283768 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_product"
[0m03:13:43.284032 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_product"} */
alter table "EnterpriseBI"."staging_mart"."dim_product__dbt_tmp" rename to "dim_product"
[0m03:13:43.284661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m03:13:43.293739 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_product: COMMIT
[0m03:13:43.294036 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_product"
[0m03:13:43.294236 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_product: COMMIT
[0m03:13:43.295375 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m03:13:43.299073 [debug] [Thread-2 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."dim_product__dbt_backup"
[0m03:13:43.301817 [debug] [Thread-2 (]: Using postgres connection "model.enterprise_bi_project.dim_product"
[0m03:13:43.302040 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_product: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_product"} */
drop table if exists "EnterpriseBI"."staging_mart"."dim_product__dbt_backup" cascade
[0m03:13:43.302416 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:13:43.303734 [debug] [Thread-2 (]: On model.enterprise_bi_project.dim_product: Close
[0m03:13:43.304815 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b8050>]}
[0m03:13:43.305198 [info ] [Thread-2 (]: 2 of 2 OK created sql table model staging_mart.dim_product ..................... [[32mSELECT 2441[0m in 0.09s]
[0m03:13:43.305510 [debug] [Thread-2 (]: Finished running node model.enterprise_bi_project.dim_product
[0m03:13:43.374319 [debug] [Thread-1 (]: SQL status: SELECT 40000 in 0.125 seconds
[0m03:13:43.376116 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_customer"
[0m03:13:43.376315 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_customer"} */
alter table "EnterpriseBI"."staging_mart"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m03:13:43.377242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:13:43.377966 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: COMMIT
[0m03:13:43.378146 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_customer"
[0m03:13:43.378310 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: COMMIT
[0m03:13:43.379766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:13:43.380825 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."dim_customer__dbt_backup"
[0m03:13:43.381180 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.dim_customer"
[0m03:13:43.381345 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.dim_customer"} */
drop table if exists "EnterpriseBI"."staging_mart"."dim_customer__dbt_backup" cascade
[0m03:13:43.381670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:13:43.382397 [debug] [Thread-1 (]: On model.enterprise_bi_project.dim_customer: Close
[0m03:13:43.382683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff2791e1-fbf0-43cc-b349-e410eb9b7890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f2a40>]}
[0m03:13:43.383007 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging_mart.dim_customer .................... [[32mSELECT 40000[0m in 0.17s]
[0m03:13:43.383297 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.dim_customer
[0m03:13:43.383921 [debug] [MainThread]: On master: COMMIT
[0m03:13:43.384083 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:43.384218 [debug] [MainThread]: On master: COMMIT
[0m03:13:43.384347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:43.397892 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m03:13:43.398146 [debug] [MainThread]: On master: Close
[0m03:13:43.398380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:43.398524 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_customer' was properly closed.
[0m03:13:43.398652 [debug] [MainThread]: Connection 'model.enterprise_bi_project.dim_product' was properly closed.
[0m03:13:43.398833 [info ] [MainThread]: 
[0m03:13:43.398997 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:13:43.399388 [debug] [MainThread]: Command end result
[0m03:13:43.424020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m03:13:43.425309 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m03:13:43.428798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m03:13:43.428998 [info ] [MainThread]: 
[0m03:13:43.429210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:13:43.429373 [info ] [MainThread]: 
[0m03:13:43.429545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m03:13:43.431805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1108423, "process_in_blocks": "0", "process_kernel_time": 0.216261, "process_mem_max_rss": "134725632", "process_out_blocks": "0", "process_user_time": 1.37465}
[0m03:13:43.432042 [debug] [MainThread]: Command `dbt run` succeeded at 03:13:43.431998 after 1.11 seconds
[0m03:13:43.432228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106806450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058afd50>]}
[0m03:13:43.432412 [debug] [MainThread]: Flushing usage events
[0m03:13:43.646950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:22:23.058240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108943890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089439d0>]}


============================== 03:22:23.067496 | 93fb5b10-e55f-4159-bfcf-95656c409381 ==============================
[0m03:22:23.067496 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:22:23.067865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt run --select fct_orders', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/bapbap23/.dbt', 'partial_parse': 'True', 'quiet': 'False'}
[0m03:22:23.192809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c58d60>]}
[0m03:22:23.224564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d08d0>]}
[0m03:22:23.225604 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m03:22:23.293818 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:22:23.387062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m03:22:23.387484 [debug] [MainThread]: Partial parsing: added file: enterprise_bi_project://models/marts/facts/fct_orders.sql
[0m03:22:23.387719 [debug] [MainThread]: Partial parsing: added file: enterprise_bi_project://models/marts/facts/fct_orders.yml
[0m03:22:23.648836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a41950>]}
[0m03:22:23.713971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m03:22:23.715545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m03:22:23.731908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c9400>]}
[0m03:22:23.732214 [info ] [MainThread]: Found 12 models, 78 data tests, 5 sources, 464 macros
[0m03:22:23.732404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e7770>]}
[0m03:22:23.733768 [info ] [MainThread]: 
[0m03:22:23.734111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:22:23.734375 [info ] [MainThread]: 
[0m03:22:23.734866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:22:23.735400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m03:22:23.779015 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m03:22:23.779258 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m03:22:23.779408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:23.886938 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.107 seconds
[0m03:22:23.888165 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m03:22:23.892651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_mart)
[0m03:22:23.897598 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m03:22:23.898071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_staging'
[0m03:22:23.898339 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m03:22:23.900057 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m03:22:23.900325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:22:23.900605 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m03:22:23.901004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:22:23.923253 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m03:22:23.923683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m03:22:23.925283 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m03:22:23.926336 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m03:22:23.926832 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m03:22:23.927115 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m03:22:23.932396 [debug] [MainThread]: Using postgres connection "master"
[0m03:22:23.932762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:22:23.933021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:22:23.951739 [debug] [MainThread]: SQL status: SELECT 5 in 0.019 seconds
[0m03:22:23.952628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce8ae0>]}
[0m03:22:23.952907 [debug] [MainThread]: On master: ROLLBACK
[0m03:22:23.953154 [debug] [MainThread]: On master: COMMIT
[0m03:22:23.953317 [debug] [MainThread]: Using postgres connection "master"
[0m03:22:23.953468 [debug] [MainThread]: On master: COMMIT
[0m03:22:23.953901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:22:23.954053 [debug] [MainThread]: On master: Close
[0m03:22:23.955584 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.fct_orders
[0m03:22:23.955919 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.fct_orders ........................... [RUN]
[0m03:22:23.956188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_mart, now model.enterprise_bi_project.fct_orders)
[0m03:22:23.956392 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.fct_orders
[0m03:22:23.961184 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.fct_orders"
[0m03:22:23.961635 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.fct_orders
[0m03:22:23.988523 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.fct_orders"
[0m03:22:23.989163 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fct_orders"
[0m03:22:23.989405 [debug] [Thread-1 (]: On model.enterprise_bi_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fct_orders"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with lines as (
    select
        order_id      as order_code,
        customer_id   as customer_code,
        store_id      as store_code,

        order_date    as order_ts,
        delivery_date as delivery_ts,
        order_status,
        order_type,

        quantity,
        unit_price,
        unit_cost
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
)

select
    order_code,

    -- dimension keys
    customer_code,
    store_code,

    -- timestamps (safe aggregation)
    min(order_ts)    as order_ts,
    max(delivery_ts) as delivery_ts,

    -- order-level metrics
    sum(quantity * unit_price)               as order_revenue,
    sum(quantity * unit_cost)                as order_cost,
    sum(quantity * (unit_price - unit_cost)) as order_margin,
    count(*)                                 as line_count,
    sum(quantity)                            as total_units,

    -- assume status/type are consistent per order
    max(order_status) as order_status,
    max(order_type)   as order_type

from lines
group by 1,2,3
  );
  
[0m03:22:23.989644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:22:25.598551 [debug] [Thread-1 (]: SQL status: SELECT 193079 in 1.608 seconds
[0m03:22:25.609515 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fct_orders"
[0m03:22:25.609760 [debug] [Thread-1 (]: On model.enterprise_bi_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fct_orders"} */
alter table "EnterpriseBI"."staging_mart"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m03:22:25.616786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m03:22:25.624563 [debug] [Thread-1 (]: On model.enterprise_bi_project.fct_orders: COMMIT
[0m03:22:25.624833 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fct_orders"
[0m03:22:25.625011 [debug] [Thread-1 (]: On model.enterprise_bi_project.fct_orders: COMMIT
[0m03:22:25.625777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:22:25.629164 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."fct_orders__dbt_backup"
[0m03:22:25.631728 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fct_orders"
[0m03:22:25.631938 [debug] [Thread-1 (]: On model.enterprise_bi_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fct_orders"} */
drop table if exists "EnterpriseBI"."staging_mart"."fct_orders__dbt_backup" cascade
[0m03:22:25.632322 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m03:22:25.633752 [debug] [Thread-1 (]: On model.enterprise_bi_project.fct_orders: Close
[0m03:22:25.634977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93fb5b10-e55f-4159-bfcf-95656c409381', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a208710>]}
[0m03:22:25.635345 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging_mart.fct_orders ...................... [[32mSELECT 193079[0m in 1.68s]
[0m03:22:25.635652 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.fct_orders
[0m03:22:25.636420 [debug] [MainThread]: On master: COMMIT
[0m03:22:25.636629 [debug] [MainThread]: Using postgres connection "master"
[0m03:22:25.636784 [debug] [MainThread]: On master: COMMIT
[0m03:22:25.636927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:22:25.651162 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m03:22:25.651453 [debug] [MainThread]: On master: Close
[0m03:22:25.651740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:22:25.651891 [debug] [MainThread]: Connection 'model.enterprise_bi_project.fct_orders' was properly closed.
[0m03:22:25.652028 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_staging' was properly closed.
[0m03:22:25.652200 [info ] [MainThread]: 
[0m03:22:25.652419 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m03:22:25.652840 [debug] [MainThread]: Command end result
[0m03:22:25.680113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m03:22:25.681641 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m03:22:25.685901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m03:22:25.686141 [info ] [MainThread]: 
[0m03:22:25.686513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:22:25.686689 [info ] [MainThread]: 
[0m03:22:25.686875 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:22:25.689398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6763096, "process_in_blocks": "0", "process_kernel_time": 0.236971, "process_mem_max_rss": "131203072", "process_out_blocks": "0", "process_user_time": 1.438056}
[0m03:22:25.689687 [debug] [MainThread]: Command `dbt run` succeeded at 03:22:25.689637 after 2.68 seconds
[0m03:22:25.689943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d07e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a7f70>]}
[0m03:22:25.690157 [debug] [MainThread]: Flushing usage events
[0m03:22:25.880961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:41:34.550483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111868590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd79d0>]}


============================== 04:41:34.559084 | bd14d3e2-c938-41dd-9857-868217819fb7 ==============================
[0m04:41:34.559084 [info ] [MainThread]: Running with dbt=1.11.2
[0m04:41:34.559438 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_orders', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/bapbap23/.dbt', 'quiet': 'False', 'log_path': '/Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/logs'}
[0m04:41:34.720691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111becd60>]}
[0m04:41:34.752150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e648d0>]}
[0m04:41:34.752754 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m04:41:34.808793 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m04:41:34.897962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m04:41:34.898556 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/facts/fact_orders.yml
[0m04:41:34.898751 [debug] [MainThread]: Partial parsing: updated file: enterprise_bi_project://models/marts/facts/fact_orders.sql
[0m04:41:35.161003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114586d50>]}
[0m04:41:35.217064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m04:41:35.218893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m04:41:35.237101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b23d40>]}
[0m04:41:35.237384 [info ] [MainThread]: Found 12 models, 79 data tests, 5 sources, 464 macros
[0m04:41:35.237569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147bc670>]}
[0m04:41:35.238855 [info ] [MainThread]: 
[0m04:41:35.239031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:41:35.239176 [info ] [MainThread]: 
[0m04:41:35.239431 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:41:35.239869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI'
[0m04:41:35.292054 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI"
[0m04:41:35.292294 [debug] [ThreadPool]: On list_EnterpriseBI: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI"} */

    select distinct nspname from pg_namespace
  
[0m04:41:35.292450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:41:35.370700 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.078 seconds
[0m04:41:35.371828 [debug] [ThreadPool]: On list_EnterpriseBI: Close
[0m04:41:35.375851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EnterpriseBI, now list_EnterpriseBI_staging_staging)
[0m04:41:35.379982 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_staging"
[0m04:41:35.380330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_EnterpriseBI_staging_mart'
[0m04:41:35.380590 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_staging"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m04:41:35.381844 [debug] [ThreadPool]: Using postgres connection "list_EnterpriseBI_staging_mart"
[0m04:41:35.382070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:41:35.382304 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "list_EnterpriseBI_staging_mart"} */
select
      'EnterpriseBI' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_mart'
    union all
    select
      'EnterpriseBI' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_mart'
  
[0m04:41:35.382619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:41:35.404243 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m04:41:35.404556 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m04:41:35.405965 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: ROLLBACK
[0m04:41:35.406930 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: ROLLBACK
[0m04:41:35.407290 [debug] [ThreadPool]: On list_EnterpriseBI_staging_staging: Close
[0m04:41:35.407475 [debug] [ThreadPool]: On list_EnterpriseBI_staging_mart: Close
[0m04:41:35.411621 [debug] [MainThread]: Using postgres connection "master"
[0m04:41:35.411932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m04:41:35.412188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:41:35.433561 [debug] [MainThread]: SQL status: SELECT 5 in 0.021 seconds
[0m04:41:35.434632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114974d50>]}
[0m04:41:35.434978 [debug] [MainThread]: On master: ROLLBACK
[0m04:41:35.435308 [debug] [MainThread]: On master: COMMIT
[0m04:41:35.435512 [debug] [MainThread]: Using postgres connection "master"
[0m04:41:35.435702 [debug] [MainThread]: On master: COMMIT
[0m04:41:35.436217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:41:35.436413 [debug] [MainThread]: On master: Close
[0m04:41:35.438396 [debug] [Thread-1 (]: Began running node model.enterprise_bi_project.fact_orders
[0m04:41:35.438745 [info ] [Thread-1 (]: 1 of 1 START sql table model staging_mart.fact_orders .......................... [RUN]
[0m04:41:35.439018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_EnterpriseBI_staging_staging, now model.enterprise_bi_project.fact_orders)
[0m04:41:35.439339 [debug] [Thread-1 (]: Began compiling node model.enterprise_bi_project.fact_orders
[0m04:41:35.444893 [debug] [Thread-1 (]: Writing injected SQL for node "model.enterprise_bi_project.fact_orders"
[0m04:41:35.445951 [debug] [Thread-1 (]: Began executing node model.enterprise_bi_project.fact_orders
[0m04:41:35.469788 [debug] [Thread-1 (]: Writing runtime sql for node "model.enterprise_bi_project.fact_orders"
[0m04:41:35.470440 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m04:41:35.470669 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */

  
    

  create  table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

with lines as (
    select
        order_id      as order_code,
        customer_id   as customer_code,
        store_id      as store_code,
        product_id    as product_code,

        order_date    as order_ts,
        delivery_date as delivery_ts,
        order_status,
        order_type,

        quantity,
        unit_price,
        unit_cost
    from "EnterpriseBI"."staging_staging"."stg_orders_line"
)

select
    order_code,

    -- dimensions / keys for slicing (including product for product analysis)
    customer_code,
    store_code,
    product_code,

    -- timestamps (min/max safe at order level)
    min(order_ts)    as order_ts,
    max(delivery_ts) as delivery_ts,

    -- metrics per order-product (sum across lines for this product in this order)
    sum(quantity * unit_price)               as order_revenue,
    sum(quantity * unit_cost)                as order_cost,
    sum(quantity * (unit_price - unit_cost)) as order_margin,
    count(*)                                as line_count,
    sum(quantity)                            as total_units,

    -- status/type at order level
    max(order_status) as order_status,
    max(order_type)   as order_type

from lines
group by 1, 2, 3, 4
  );
  
[0m04:41:35.470881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:38.196089 [debug] [Thread-1 (]: SQL status: SELECT 555816 in 2.725 seconds
[0m04:41:38.213097 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m04:41:38.213631 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
alter table "EnterpriseBI"."staging_mart"."fact_orders" rename to "fact_orders__dbt_backup"
[0m04:41:38.214920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:41:38.216485 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m04:41:38.216689 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
alter table "EnterpriseBI"."staging_mart"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m04:41:38.222809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m04:41:38.236583 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: COMMIT
[0m04:41:38.237083 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m04:41:38.237435 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: COMMIT
[0m04:41:38.240834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m04:41:38.244348 [debug] [Thread-1 (]: Applying DROP to: "EnterpriseBI"."staging_mart"."fact_orders__dbt_backup"
[0m04:41:38.247047 [debug] [Thread-1 (]: Using postgres connection "model.enterprise_bi_project.fact_orders"
[0m04:41:38.247263 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enterprise_bi_project", "target_name": "dev", "node_id": "model.enterprise_bi_project.fact_orders"} */
drop table if exists "EnterpriseBI"."staging_mart"."fact_orders__dbt_backup" cascade
[0m04:41:38.251199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m04:41:38.252688 [debug] [Thread-1 (]: On model.enterprise_bi_project.fact_orders: Close
[0m04:41:38.253868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd14d3e2-c938-41dd-9857-868217819fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e78350>]}
[0m04:41:38.254254 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging_mart.fact_orders ..................... [[32mSELECT 555816[0m in 2.81s]
[0m04:41:38.254577 [debug] [Thread-1 (]: Finished running node model.enterprise_bi_project.fact_orders
[0m04:41:38.255343 [debug] [MainThread]: On master: COMMIT
[0m04:41:38.255514 [debug] [MainThread]: Using postgres connection "master"
[0m04:41:38.255665 [debug] [MainThread]: On master: COMMIT
[0m04:41:38.255804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:41:38.320506 [debug] [MainThread]: SQL status: COMMIT in 0.064 seconds
[0m04:41:38.322040 [debug] [MainThread]: On master: Close
[0m04:41:38.322997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:41:38.323883 [debug] [MainThread]: Connection 'model.enterprise_bi_project.fact_orders' was properly closed.
[0m04:41:38.324624 [debug] [MainThread]: Connection 'list_EnterpriseBI_staging_mart' was properly closed.
[0m04:41:38.325370 [info ] [MainThread]: 
[0m04:41:38.325977 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m04:41:38.327180 [debug] [MainThread]: Command end result
[0m04:41:38.390024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/manifest.json
[0m04:41:38.391620 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/semantic_manifest.json
[0m04:41:38.395393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/bapbap23/Desktop/Enterprise_BI_Project_Repo/target/run_results.json
[0m04:41:38.395644 [info ] [MainThread]: 
[0m04:41:38.395894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:41:38.396096 [info ] [MainThread]: 
[0m04:41:38.396286 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:41:38.399919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8917093, "process_in_blocks": "0", "process_kernel_time": 0.263425, "process_mem_max_rss": "130973696", "process_out_blocks": "0", "process_user_time": 1.419145}
[0m04:41:38.400276 [debug] [MainThread]: Command `dbt run` succeeded at 04:41:38.400223 after 3.89 seconds
[0m04:41:38.400509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114982570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e51e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e51db0>]}
[0m04:41:38.400717 [debug] [MainThread]: Flushing usage events
[0m04:41:38.578384 [debug] [MainThread]: An error was encountered while trying to flush usage events
